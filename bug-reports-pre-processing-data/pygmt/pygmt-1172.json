{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "body": "**Description of the problem**\r\n\r\nOriginally found in https://github.com/GenericMappingTools/pygmt/pull/1154#discussion_r606749263\r\n\r\n**Full code that generated the error**\r\n\r\n```python\r\nimport pygmt\r\n\r\npygmt.show_versions()\r\n\r\nxrgrid = pygmt.grdcut(\"@earth_relief_01d\", region=[-116, -109, -47, -44])\r\nprint(xrgrid.gmt.gtype)\r\n\r\nfig = pygmt.Figure()\r\nfig.grdview(grid=xrgrid, frame=True)\r\nfig.savefig(\"grdview.png\")\r\n\r\nfig = pygmt.Figure()\r\nfig.grdimage(grid=xrgrid, frame=True)\r\nfig.savefig(\"grdimage.png\")\r\n```\r\n\r\n`xrgrid.gmt.gtype` is 1, so the grid is a geographic grid. However, the grid is still plotted as a Cartesian grid.\r\n\r\n| grdview | grdimage | \r\n|---|---|\r\n| ![image](https://user-images.githubusercontent.com/3974108/113499812-f7759800-94e6-11eb-8936-e04110c6bbd8.png) | ![image](https://user-images.githubusercontent.com/3974108/113499805-efb5f380-94e6-11eb-9428-a9b336368ad0.png) |\r\n\r\n\r\n**System information**\r\n\r\nPlease paste the output of `python -c \"import pygmt; pygmt.show_versions()\"`:\r\n\r\n```\r\nPyGMT information:\r\n  version: v0.3.2.dev65+g9b57cc97.d20210404\r\nSystem information:\r\n  python: 3.9.2 | packaged by conda-forge | (default, Feb 21 2021, 05:02:20)  [Clang 11.0.1 ]\r\n  executable: /Users/user/.miniconda/envs/pygmt/bin/python\r\n  machine: macOS-11.2.3-x86_64-i386-64bit\r\nDependency information:\r\n  numpy: 1.20.1\r\n  pandas: 1.2.3\r\n  xarray: 0.17.0\r\n  netCDF4: 1.5.6\r\n  packaging: 20.9\r\n  ghostscript: 9.53.3\r\n  gmt: 6.1.1\r\nGMT library information:\r\n  binary dir: /Users/user/.miniconda/envs/pygmt/bin\r\n  cores: 8\r\n  grid layout: rows\r\n  library path: /Users/user/.miniconda/envs/pygmt/lib/libgmt.dylib\r\n  padding: 2\r\n  plugin dir: /Users/user/.miniconda/envs/pygmt/lib/gmt/plugins\r\n  share dir: /Users/user/.miniconda/envs/pygmt/share/gmt\r\n  version: 6.1.1\r\n```\r\n",
    "closed_at": "2021-04-22T21:42:51Z",
    "closed_by": {
        "avatar_url": "https://avatars.githubusercontent.com/u/23487320?v=4",
        "events_url": "https://api.github.com/users/weiji14/events{/privacy}",
        "followers_url": "https://api.github.com/users/weiji14/followers",
        "following_url": "https://api.github.com/users/weiji14/following{/other_user}",
        "gists_url": "https://api.github.com/users/weiji14/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/weiji14",
        "id": 23487320,
        "login": "weiji14",
        "node_id": "MDQ6VXNlcjIzNDg3MzIw",
        "organizations_url": "https://api.github.com/users/weiji14/orgs",
        "received_events_url": "https://api.github.com/users/weiji14/received_events",
        "repos_url": "https://api.github.com/users/weiji14/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/weiji14/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/weiji14/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/weiji14"
    },
    "comments": 3,
    "comments_content": [
        {
            "author_association": "MEMBER",
            "body": "@PaulWessel This looks like an upstream GMT bug. \r\n\r\nHere is a minimal script to reproduce the issue. It extracts a subregion from the earth_relief_01d grid, and then plot it using `grdview`. It's a geographic grid and should use a geographic projection, but it uses a Cartesian projection (see the image above).\r\n```\r\nimport pygmt\r\n\r\nxrgrid = pygmt.grdcut(\"@earth_relief_01d\", region=[-116, -109, -47, -44])\r\n\r\nfig = pygmt.Figure()\r\nfig.grdview(grid=xrgrid, frame=True)\r\nfig.savefig(\"grdview.png\")\r\n```\r\n\r\nInternally, PyGMT calls the `GMT_Create_Data` function, and then calls `GMT_Put_Matrix`. Here are the arguments passed to `GMT_Create_Data`:\r\n```\r\nGMT_Create_Data(API, GMT_IS_GRID|GMT_VIA_MATRIX, GMT_IS_SURFACE, GMT_CONTAINER_ONLY|GMT_GRID_IS_GEO, ranges, incs, GMT_GRID_PIXEL_REG)\r\n```\r\n",
            "created_at": "2021-04-04T16:51:59Z",
            "html_url": "https://github.com/GenericMappingTools/pygmt/issues/1172#issuecomment-813064030",
            "id": 813064030,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/1172",
            "node_id": "MDEyOklzc3VlQ29tbWVudDgxMzA2NDAzMA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/813064030/reactions"
            },
            "updated_at": "2021-04-04T16:51:59Z",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/813064030",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3974108?v=4",
                "events_url": "https://api.github.com/users/seisman/events{/privacy}",
                "followers_url": "https://api.github.com/users/seisman/followers",
                "following_url": "https://api.github.com/users/seisman/following{/other_user}",
                "gists_url": "https://api.github.com/users/seisman/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/seisman",
                "id": 3974108,
                "login": "seisman",
                "node_id": "MDQ6VXNlcjM5NzQxMDg=",
                "organizations_url": "https://api.github.com/users/seisman/orgs",
                "received_events_url": "https://api.github.com/users/seisman/received_events",
                "repos_url": "https://api.github.com/users/seisman/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/seisman/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/seisman/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/seisman"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Here is what happens: Your **GMT_GRID_IS_GEO** bit-flag only leads to a call to `gmt_set_geographic (GMT, GMT_OUT); `inside _GMT_Create_Data_. Never mind that you did not pass **GMT_IS_OUTPUT** so this should be considered a grid for input, not output [I think I need to fix that bug which probably is not affecting many things anyway].  But even so, once your **fig.grdview** command is run a new session is created (right?) so there is no memory of setting anything to geographic.  The solution is clearly to embed this info in the **GMT_MATRIX** structure, and that will mean in its `void *hidden` structure since there is no attribute in the **GMT_MATRIX** structure to hold that information.  If we add a flag in the hidden struct that is set to geo then the _GMT_Read_Data_ branch dealing with input matrices can explore that setting and call _gmt_set_geographic_ as needed.  I think that is the solution here.  Agree?\r\n",
            "created_at": "2021-04-04T21:06:12Z",
            "html_url": "https://github.com/GenericMappingTools/pygmt/issues/1172#issuecomment-813099186",
            "id": 813099186,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/1172",
            "node_id": "MDEyOklzc3VlQ29tbWVudDgxMzA5OTE4Ng==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/813099186/reactions"
            },
            "updated_at": "2021-04-04T21:06:12Z",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/813099186",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/26473567?v=4",
                "events_url": "https://api.github.com/users/PaulWessel/events{/privacy}",
                "followers_url": "https://api.github.com/users/PaulWessel/followers",
                "following_url": "https://api.github.com/users/PaulWessel/following{/other_user}",
                "gists_url": "https://api.github.com/users/PaulWessel/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/PaulWessel",
                "id": 26473567,
                "login": "PaulWessel",
                "node_id": "MDQ6VXNlcjI2NDczNTY3",
                "organizations_url": "https://api.github.com/users/PaulWessel/orgs",
                "received_events_url": "https://api.github.com/users/PaulWessel/received_events",
                "repos_url": "https://api.github.com/users/PaulWessel/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/PaulWessel/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/PaulWessel/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/PaulWessel"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "The issue has been fixed in https://github.com/GenericMappingTools/gmt/pull/5091 and https://github.com/GenericMappingTools/gmt/pull/5092",
            "created_at": "2021-04-05T15:56:28Z",
            "html_url": "https://github.com/GenericMappingTools/pygmt/issues/1172#issuecomment-813469043",
            "id": 813469043,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/1172",
            "node_id": "MDEyOklzc3VlQ29tbWVudDgxMzQ2OTA0Mw==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/813469043/reactions"
            },
            "updated_at": "2021-04-05T15:56:28Z",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/813469043",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3974108?v=4",
                "events_url": "https://api.github.com/users/seisman/events{/privacy}",
                "followers_url": "https://api.github.com/users/seisman/followers",
                "following_url": "https://api.github.com/users/seisman/following{/other_user}",
                "gists_url": "https://api.github.com/users/seisman/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/seisman",
                "id": 3974108,
                "login": "seisman",
                "node_id": "MDQ6VXNlcjM5NzQxMDg=",
                "organizations_url": "https://api.github.com/users/seisman/orgs",
                "received_events_url": "https://api.github.com/users/seisman/received_events",
                "repos_url": "https://api.github.com/users/seisman/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/seisman/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/seisman/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/seisman"
            }
        }
    ],
    "comments_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/1172/comments",
    "created_at": "2021-04-04T05:42:19Z",
    "events_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/1172/events",
    "html_url": "https://github.com/GenericMappingTools/pygmt/issues/1172",
    "id": 849804575,
    "labels": [
        {
            "color": "ee0701",
            "default": true,
            "description": "Something isn't working",
            "id": 563309827,
            "name": "bug",
            "node_id": "MDU6TGFiZWw1NjMzMDk4Mjc=",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/labels/bug"
        },
        {
            "color": "e8ff6b",
            "default": false,
            "description": "Bug or missing feature of upstream core GMT",
            "id": 2059525605,
            "name": "upstream",
            "node_id": "MDU6TGFiZWwyMDU5NTI1NjA1",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/labels/upstream"
        }
    ],
    "labels_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/1172/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": "2021-06-21T14:49:45Z",
        "closed_issues": 244,
        "created_at": "2020-11-21T04:47:19Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/3974108?v=4",
            "events_url": "https://api.github.com/users/seisman/events{/privacy}",
            "followers_url": "https://api.github.com/users/seisman/followers",
            "following_url": "https://api.github.com/users/seisman/following{/other_user}",
            "gists_url": "https://api.github.com/users/seisman/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/seisman",
            "id": 3974108,
            "login": "seisman",
            "node_id": "MDQ6VXNlcjM5NzQxMDg=",
            "organizations_url": "https://api.github.com/users/seisman/orgs",
            "received_events_url": "https://api.github.com/users/seisman/received_events",
            "repos_url": "https://api.github.com/users/seisman/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/seisman/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/seisman/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/seisman"
        },
        "description": "",
        "due_on": "2021-06-20T07:00:00Z",
        "html_url": "https://github.com/GenericMappingTools/pygmt/milestone/6",
        "id": 6133205,
        "labels_url": "https://api.github.com/repos/GenericMappingTools/pygmt/milestones/6/labels",
        "node_id": "MDk6TWlsZXN0b25lNjEzMzIwNQ==",
        "number": 6,
        "open_issues": 0,
        "state": "closed",
        "title": "0.4.0",
        "updated_at": "2021-11-03T23:29:33Z",
        "url": "https://api.github.com/repos/GenericMappingTools/pygmt/milestones/6"
    },
    "node_id": "MDU6SXNzdWU4NDk4MDQ1NzU=",
    "number": 1172,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 1,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 1,
        "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/1172/reactions"
    },
    "repository_url": "https://api.github.com/repos/GenericMappingTools/pygmt",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/1172/timeline",
    "title": "Geographic xarray.DataArray grid is plotted as Cartesian grid",
    "updated_at": "2021-04-22T21:45:07Z",
    "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/1172",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/3974108?v=4",
        "events_url": "https://api.github.com/users/seisman/events{/privacy}",
        "followers_url": "https://api.github.com/users/seisman/followers",
        "following_url": "https://api.github.com/users/seisman/following{/other_user}",
        "gists_url": "https://api.github.com/users/seisman/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/seisman",
        "id": 3974108,
        "login": "seisman",
        "node_id": "MDQ6VXNlcjM5NzQxMDg=",
        "organizations_url": "https://api.github.com/users/seisman/orgs",
        "received_events_url": "https://api.github.com/users/seisman/received_events",
        "repos_url": "https://api.github.com/users/seisman/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/seisman/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/seisman/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/seisman"
    }
}