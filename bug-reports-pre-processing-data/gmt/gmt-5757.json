{
    "active_lock_reason": null,
    "assignee": {
        "avatar_url": "https://avatars.githubusercontent.com/u/26473567?v=4",
        "events_url": "https://api.github.com/users/PaulWessel/events{/privacy}",
        "followers_url": "https://api.github.com/users/PaulWessel/followers",
        "following_url": "https://api.github.com/users/PaulWessel/following{/other_user}",
        "gists_url": "https://api.github.com/users/PaulWessel/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/PaulWessel",
        "id": 26473567,
        "login": "PaulWessel",
        "node_id": "MDQ6VXNlcjI2NDczNTY3",
        "organizations_url": "https://api.github.com/users/PaulWessel/orgs",
        "received_events_url": "https://api.github.com/users/PaulWessel/received_events",
        "repos_url": "https://api.github.com/users/PaulWessel/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/PaulWessel/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/PaulWessel/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/PaulWessel"
    },
    "assignees": [
        {
            "avatar_url": "https://avatars.githubusercontent.com/u/26473567?v=4",
            "events_url": "https://api.github.com/users/PaulWessel/events{/privacy}",
            "followers_url": "https://api.github.com/users/PaulWessel/followers",
            "following_url": "https://api.github.com/users/PaulWessel/following{/other_user}",
            "gists_url": "https://api.github.com/users/PaulWessel/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/PaulWessel",
            "id": 26473567,
            "login": "PaulWessel",
            "node_id": "MDQ6VXNlcjI2NDczNTY3",
            "organizations_url": "https://api.github.com/users/PaulWessel/orgs",
            "received_events_url": "https://api.github.com/users/PaulWessel/received_events",
            "repos_url": "https://api.github.com/users/PaulWessel/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/PaulWessel/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/PaulWessel/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/PaulWessel"
        }
    ],
    "author_association": "MEMBER",
    "body": "<!--To help us understand and resolve your issue, please fill out the form to the best of your ability. Feel free to delete the sections that do not apply.-->\r\n\r\n**Description of the problem**\r\n\r\nIn experimenting with a movie that uses @earth_relief and where the resolution depends on the settings (#5753 ), **movie** is launching many jobs to make the frames, and these all run concurrently.  If many or all of them decide they need to use @earth_relief_01m (which is a tiled dataset) then it results in a flurry of calls via curl to download the individual tiles.  Hence several concurrent jobs may seek to download the exact same file, e.g., N60E120.earth_relief_01m_p.nc.  We prevent this chaos by creating a _lock file_ with the name /tmp/_file_.download and then apply standard file lock protocols (_fcntl_ for the *nix and _LockFileEx_ on Windows).  What this does is to deny the other processes access - they will hang until the lock is released.  However, when it is released the file of interest has been downloaded so the whole need to download again has gone away, but it is too late - we are too committed at this point.  Other jobs may successfully be reading the downloaded file when another process starts re-downloading and ruining it - leading to failed plots [there are some guesses on my part here - hard to debug this scenario...].\r\n\r\nIt seems the solution here would be that once the lock is released (which means the file has been downloaded or possibly failed for other reasons) we should _check again_ if the file is there before we continue to download.  If the file miraculously has arrived (via one of the other processes) then we should abort the download and get back to treating it as a file on the system.  It seems if we simply return from gmt_download_file with no error at that point it should continue as if it was successful.\r\n\r\nAny thoughts or experiences on this, @GenericMappingTools/core ?",
    "closed_at": "2021-09-15T02:29:31Z",
    "closed_by": {
        "avatar_url": "https://avatars.githubusercontent.com/u/26473567?v=4",
        "events_url": "https://api.github.com/users/PaulWessel/events{/privacy}",
        "followers_url": "https://api.github.com/users/PaulWessel/followers",
        "following_url": "https://api.github.com/users/PaulWessel/following{/other_user}",
        "gists_url": "https://api.github.com/users/PaulWessel/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/PaulWessel",
        "id": 26473567,
        "login": "PaulWessel",
        "node_id": "MDQ6VXNlcjI2NDczNTY3",
        "organizations_url": "https://api.github.com/users/PaulWessel/orgs",
        "received_events_url": "https://api.github.com/users/PaulWessel/received_events",
        "repos_url": "https://api.github.com/users/PaulWessel/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/PaulWessel/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/PaulWessel/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/PaulWessel"
    },
    "comments": 5,
    "comments_content": [
        {
            "author_association": "NONE",
            "body": "\ud83d\udc4b Thanks for opening your first issue here! Please make sure you filled out the template with as much detail as possible. We appreciate that you took the time to contribute!\n\nPlease make sure you read our [Contributing Guide](https://github.com/GenericMappingTools/gmt/blob/master/CONTRIBUTING.md) and abide by our [Code of Conduct](https://github.com/GenericMappingTools/gmt/blob/master/CODE_OF_CONDUCT.md).\n",
            "created_at": "2021-09-14T21:42:40Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/issues/5757#issuecomment-919533770",
            "id": 919533770,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5757",
            "node_id": "IC_kwDOCJzWHc42zvjK",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/919533770/reactions"
            },
            "updated_at": "2021-09-14T21:42:40Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/919533770",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/in/4141?v=4",
                "events_url": "https://api.github.com/users/welcome%5Bbot%5D/events{/privacy}",
                "followers_url": "https://api.github.com/users/welcome%5Bbot%5D/followers",
                "following_url": "https://api.github.com/users/welcome%5Bbot%5D/following{/other_user}",
                "gists_url": "https://api.github.com/users/welcome%5Bbot%5D/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/apps/welcome",
                "id": 30606887,
                "login": "welcome[bot]",
                "node_id": "MDM6Qm90MzA2MDY4ODc=",
                "organizations_url": "https://api.github.com/users/welcome%5Bbot%5D/orgs",
                "received_events_url": "https://api.github.com/users/welcome%5Bbot%5D/received_events",
                "repos_url": "https://api.github.com/users/welcome%5Bbot%5D/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/welcome%5Bbot%5D/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/welcome%5Bbot%5D/subscriptions",
                "type": "Bot",
                "url": "https://api.github.com/users/welcome%5Bbot%5D"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "This is the error that regularly causes a few tests to fail when the tests are run on many cores:\r\n\r\n```\r\ngmt [ERROR]: Failed to open /Users/User/.gmt/server/gmt_data_server.txt! [fopen error: No such file or directory]\r\ngmt [ERROR]: Failed to rename /Users/User/.gmt/server/gmt_data_server.txt to /Users/User/.gmt/server/gmt_data_server.txt.old.\r\ngrdgradient [ERROR]: Libcurl Error: HTTP response code said error\r\ngrdgradient [WARNING]: You can turn remote file download off by setting GMT_DATA_UPDATE_INTERVAL to \"off\"\r\ngrdgradient [ERROR]: File /Users/User/.gmt/cache/earth_relief_05m_g was not found\r\ngrdgradient [ERROR]: Cannot find file /Users/User/.gmt/cache/earth_relief_05m_g\r\ngrdgradient [ERROR]: File /Users/User/.gmt/cache/earth_relief_05m_g was not found\r\ngrdgradient [ERROR]: Cannot find file /Users/User/.gmt/cache/earth_relief_05m_g\r\ngrdgradient [ERROR]: File /Users/User/.gmt/cache/earth_relief_05m_g not found\r\n[Session gmt (0)]: Error returned from GMT API: GMT_FILE_NOT_FOUND (16)\r\n```",
            "created_at": "2021-09-17T20:29:40Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/issues/5757#issuecomment-922063398",
            "id": 922063398,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5757",
            "node_id": "IC_kwDOCJzWHc429ZIm",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/922063398/reactions"
            },
            "updated_at": "2021-09-17T20:29:40Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/922063398",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/14077947?v=4",
                "events_url": "https://api.github.com/users/maxrjones/events{/privacy}",
                "followers_url": "https://api.github.com/users/maxrjones/followers",
                "following_url": "https://api.github.com/users/maxrjones/following{/other_user}",
                "gists_url": "https://api.github.com/users/maxrjones/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/maxrjones",
                "id": 14077947,
                "login": "maxrjones",
                "node_id": "MDQ6VXNlcjE0MDc3OTQ3",
                "organizations_url": "https://api.github.com/users/maxrjones/orgs",
                "received_events_url": "https://api.github.com/users/maxrjones/received_events",
                "repos_url": "https://api.github.com/users/maxrjones/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/maxrjones/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/maxrjones/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/maxrjones"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "@meghanrjones, perhaps #5777 will help - it seems correct to do regardless of the issue above though.",
            "created_at": "2021-09-17T21:02:59Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/issues/5757#issuecomment-922079886",
            "id": 922079886,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5757",
            "node_id": "IC_kwDOCJzWHc429dKO",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/922079886/reactions"
            },
            "updated_at": "2021-09-17T21:02:59Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/922079886",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/26473567?v=4",
                "events_url": "https://api.github.com/users/PaulWessel/events{/privacy}",
                "followers_url": "https://api.github.com/users/PaulWessel/followers",
                "following_url": "https://api.github.com/users/PaulWessel/following{/other_user}",
                "gists_url": "https://api.github.com/users/PaulWessel/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/PaulWessel",
                "id": 26473567,
                "login": "PaulWessel",
                "node_id": "MDQ6VXNlcjI2NDczNTY3",
                "organizations_url": "https://api.github.com/users/PaulWessel/orgs",
                "received_events_url": "https://api.github.com/users/PaulWessel/received_events",
                "repos_url": "https://api.github.com/users/PaulWessel/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/PaulWessel/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/PaulWessel/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/PaulWessel"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> @meghanrjones, perhaps #5777 will help - it seems correct to do regardless of the issue above though.\r\n\r\nDidn't get the previous error with that branch, but did receive this oddity (since `test/grdsample/resample.sh` only uses classic mode).\r\n\r\n```\r\n 493/1098 Test  #523: test/grdsample/resample.sh ...................***Failed    0.80 sec\r\nSet GMT_SESSION_NAME = 10010\r\ngmt [ERROR]: Option -K not allowed for modern GMT mode.\r\nERROR: gmtest:82\r\n```",
            "created_at": "2021-09-17T21:11:44Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/issues/5757#issuecomment-922084308",
            "id": 922084308,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5757",
            "node_id": "IC_kwDOCJzWHc429ePU",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/922084308/reactions"
            },
            "updated_at": "2021-09-17T21:11:44Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/922084308",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/14077947?v=4",
                "events_url": "https://api.github.com/users/maxrjones/events{/privacy}",
                "followers_url": "https://api.github.com/users/maxrjones/followers",
                "following_url": "https://api.github.com/users/maxrjones/following{/other_user}",
                "gists_url": "https://api.github.com/users/maxrjones/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/maxrjones",
                "id": 14077947,
                "login": "maxrjones",
                "node_id": "MDQ6VXNlcjE0MDc3OTQ3",
                "organizations_url": "https://api.github.com/users/maxrjones/orgs",
                "received_events_url": "https://api.github.com/users/maxrjones/received_events",
                "repos_url": "https://api.github.com/users/maxrjones/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/maxrjones/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/maxrjones/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/maxrjones"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Yes, that is another type of error hard to track down.  I do get that from time to time as well, and rerunning that test with ctest -R resample.sh will show that it passes.  These things are intermittent but related to ctest running things in parallel.  Perhaps some tests end up with the same PPID and this happens.\r\n",
            "created_at": "2021-09-17T21:15:16Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/issues/5757#issuecomment-922085973",
            "id": 922085973,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5757",
            "node_id": "IC_kwDOCJzWHc429epV",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/922085973/reactions"
            },
            "updated_at": "2021-09-17T21:15:16Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/922085973",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/26473567?v=4",
                "events_url": "https://api.github.com/users/PaulWessel/events{/privacy}",
                "followers_url": "https://api.github.com/users/PaulWessel/followers",
                "following_url": "https://api.github.com/users/PaulWessel/following{/other_user}",
                "gists_url": "https://api.github.com/users/PaulWessel/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/PaulWessel",
                "id": 26473567,
                "login": "PaulWessel",
                "node_id": "MDQ6VXNlcjI2NDczNTY3",
                "organizations_url": "https://api.github.com/users/PaulWessel/orgs",
                "received_events_url": "https://api.github.com/users/PaulWessel/received_events",
                "repos_url": "https://api.github.com/users/PaulWessel/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/PaulWessel/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/PaulWessel/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/PaulWessel"
            }
        }
    ],
    "comments_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5757/comments",
    "created_at": "2021-09-14T21:42:39Z",
    "events_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5757/events",
    "html_url": "https://github.com/GenericMappingTools/gmt/issues/5757",
    "id": 996465365,
    "labels": [
        {
            "color": "d73a4a",
            "default": true,
            "description": "Something isn't working",
            "id": 1022239695,
            "name": "bug",
            "node_id": "MDU6TGFiZWwxMDIyMjM5Njk1",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/labels/bug"
        }
    ],
    "labels_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5757/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOCJzWHc47ZNrV",
    "number": 5757,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5757/reactions"
    },
    "repository_url": "https://api.github.com/repos/GenericMappingTools/gmt",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5757/timeline",
    "title": "Need better handling when simultaneous jobs are trying to download the same file",
    "updated_at": "2021-09-17T21:15:16Z",
    "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5757",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/26473567?v=4",
        "events_url": "https://api.github.com/users/PaulWessel/events{/privacy}",
        "followers_url": "https://api.github.com/users/PaulWessel/followers",
        "following_url": "https://api.github.com/users/PaulWessel/following{/other_user}",
        "gists_url": "https://api.github.com/users/PaulWessel/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/PaulWessel",
        "id": 26473567,
        "login": "PaulWessel",
        "node_id": "MDQ6VXNlcjI2NDczNTY3",
        "organizations_url": "https://api.github.com/users/PaulWessel/orgs",
        "received_events_url": "https://api.github.com/users/PaulWessel/received_events",
        "repos_url": "https://api.github.com/users/PaulWessel/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/PaulWessel/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/PaulWessel/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/PaulWessel"
    }
}