{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "body": "<!--To help us understand and resolve your issue, please fill out the form to the best of your ability. Feel free to delete the sections that do not apply.-->\r\n\r\n**Description of the problem**\r\n\r\nThis issue was originally reported in https://forum.generic-mapping-tools.org/t/grdtrack-results-inconsistent-when-same-data-read-with-xarray-vs-from-grd-file/2197, which is a PyGMT example, but the problem is with the GMT API so I am opening the issue here.\r\n\r\nSteps for reproducing the issue:\r\n\r\nBash:\r\n```\r\ngmt grdmath -R0/2/0/2 -I1 X EXP = grdtracktest.nc\r\n```\r\n\r\nPython:\r\n```\r\nimport pygmt\r\n\r\ngrid = pygmt.load_dataarray(\"grdtracktest.nc\")\r\n\r\nprint(pygmt.grdtrack(points=[0.5, 0.5], grid=grid, interpolation=\"c\"))\r\nprint(pygmt.grdtrack(points=[0.5, 0.5], grid=\"grdtracktest.nc\", interpolation=\"c\"))\r\n```\r\n\r\n<!-- Tip: you'll get more detailed error messages if you add -Vd to your gmt commands. -->\r\n\r\n\r\n**Actual outcome**\r\n\r\n<!--The output produced by the above script, which may be a screenshot, console output, etc.-->\r\n\r\n```\r\n0  0.5  0.5  1.859141\r\n0  0.5  0.5  1.778409\r\n```\r\n\r\n**Expected outcome**\r\n\r\n```\r\n0  0.5  0.5 1.778409\r\n0  0.5  0.5  1.778409\r\n```\r\n\r\n\r\n**System information**\r\n\r\n* Operating system: macOS\r\n* GMT version (`gmt --version`): dev branches for PyGMT and GMT\r\n",
    "closed_at": "2021-10-21T19:59:18Z",
    "closed_by": {
        "avatar_url": "https://avatars.githubusercontent.com/u/14077947?v=4",
        "events_url": "https://api.github.com/users/maxrjones/events{/privacy}",
        "followers_url": "https://api.github.com/users/maxrjones/followers",
        "following_url": "https://api.github.com/users/maxrjones/following{/other_user}",
        "gists_url": "https://api.github.com/users/maxrjones/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/maxrjones",
        "id": 14077947,
        "login": "maxrjones",
        "node_id": "MDQ6VXNlcjE0MDc3OTQ3",
        "organizations_url": "https://api.github.com/users/maxrjones/orgs",
        "received_events_url": "https://api.github.com/users/maxrjones/received_events",
        "repos_url": "https://api.github.com/users/maxrjones/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/maxrjones/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/maxrjones/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/maxrjones"
    },
    "comments": 4,
    "comments_content": [
        {
            "author_association": "MEMBER",
            "body": "I am running into an issue with debugging here with the assert statement in `gmt_bcr_get_z_fast`: `assert (node < G->header->size);`).\r\n\r\nFor the virtual file, `G->header->size = 9` (G->header->mx = G->header->my = 3).\r\nFor the actual file, `G-> header->size=49` (G->header->mx = G->header->my = 7). \r\n\r\n@PaulWessel, do you think this is a padding problem? Here's the ncdump for the file:\r\n```\r\nnetcdf grdtracktest {\r\ndimensions:\r\n\tx = 3 ;\r\n\ty = 3 ;\r\nvariables:\r\n\tdouble x(x) ;\r\n\t\tx:long_name = \"x\" ;\r\n\t\tx:actual_range = 0., 2. ;\r\n\tdouble y(y) ;\r\n\t\ty:long_name = \"y\" ;\r\n\t\ty:actual_range = 0., 2. ;\r\n\tfloat z(y, x) ;\r\n\t\tz:long_name = \"z\" ;\r\n\t\tz:_FillValue = NaNf ;\r\n\t\tz:actual_range = 1., 7.38905620574951 ;\r\n\r\n// global attributes:\r\n\t\t:Conventions = \"CF-1.7\" ;\r\n\t\t:title = \"Produced by grdmath\" ;\r\n\t\t:history = \"grdmath -R0/2/0/2 -I1 X EXP = grdtracktest.nc\" ;\r\n\t\t:GMT_version = \"6.3.0_47acf7c-dirty_2021.10.20 [64-bit]\" ;\r\ndata:\r\n\r\n x = 0, 1, 2 ;\r\n\r\n y = 0, 1, 2 ;\r\n\r\n z =\r\n  1, 2.718282, 7.389056,\r\n  1, 2.718282, 7.389056,\r\n  1, 2.718282, 7.389056 ;\r\n}\r\n```\r\n",
            "created_at": "2021-10-20T21:03:05Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/issues/5882#issuecomment-948034626",
            "id": 948034626,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5882",
            "node_id": "IC_kwDOCJzWHc44gdxC",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/948034626/reactions"
            },
            "updated_at": "2021-10-20T21:03:05Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/948034626",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/14077947?v=4",
                "events_url": "https://api.github.com/users/maxrjones/events{/privacy}",
                "followers_url": "https://api.github.com/users/maxrjones/followers",
                "following_url": "https://api.github.com/users/maxrjones/following{/other_user}",
                "gists_url": "https://api.github.com/users/maxrjones/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/maxrjones",
                "id": 14077947,
                "login": "maxrjones",
                "node_id": "MDQ6VXNlcjE0MDc3OTQ3",
                "organizations_url": "https://api.github.com/users/maxrjones/orgs",
                "received_events_url": "https://api.github.com/users/maxrjones/received_events",
                "repos_url": "https://api.github.com/users/maxrjones/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/maxrjones/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/maxrjones/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/maxrjones"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Seems OK. When a file is read it gets padded so nx = ny = 3 and nm = 9 in both cases but the mx, my and hence size will differ.  Thus, in the gmt_bcr_get_z_fast the node that is being used should be compatible (row, col -> node will be computed with header->pad info so if no pad then  you would get nodes in 0-8 range but if pad then they are in the 16-?? range with jumps.  Is the assert causing any problems?",
            "created_at": "2021-10-20T21:11:09Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/issues/5882#issuecomment-948039962",
            "id": 948039962,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5882",
            "node_id": "IC_kwDOCJzWHc44gfEa",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/948039962/reactions"
            },
            "updated_at": "2021-10-20T21:11:09Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/948039962",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/26473567?v=4",
                "events_url": "https://api.github.com/users/PaulWessel/events{/privacy}",
                "followers_url": "https://api.github.com/users/PaulWessel/followers",
                "following_url": "https://api.github.com/users/PaulWessel/following{/other_user}",
                "gists_url": "https://api.github.com/users/PaulWessel/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/PaulWessel",
                "id": 26473567,
                "login": "PaulWessel",
                "node_id": "MDQ6VXNlcjI2NDczNTY3",
                "organizations_url": "https://api.github.com/users/PaulWessel/orgs",
                "received_events_url": "https://api.github.com/users/PaulWessel/received_events",
                "repos_url": "https://api.github.com/users/PaulWessel/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/PaulWessel/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/PaulWessel/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/PaulWessel"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "This is a duplicate issue of https://github.com/GenericMappingTools/pygmt/issues/1309, where a temporary solution was implemented that restricts external grids with no pads to bilinear (https://github.com/GenericMappingTools/gmt/pull/5283). I think we should have a warning in the GMT code when GMT->common.n.interpolate is reset to 1 for external grids (grdtrack.c L802), otherwise the user has no idea why their request isn't honored. \r\n\r\n@PaulWessel, is your suggestion from https://github.com/GenericMappingTools/pygmt/issues/1309#issuecomment-851127682 the permanent solution for this issue? We can convert that comment to a new issue in the GMT repository if that's the case so that it doesn't get lost.",
            "created_at": "2021-10-21T15:09:36Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/issues/5882#issuecomment-948714082",
            "id": 948714082,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5882",
            "node_id": "IC_kwDOCJzWHc44jDpi",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/948714082/reactions"
            },
            "updated_at": "2021-10-21T15:09:36Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/948714082",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/14077947?v=4",
                "events_url": "https://api.github.com/users/maxrjones/events{/privacy}",
                "followers_url": "https://api.github.com/users/maxrjones/followers",
                "following_url": "https://api.github.com/users/maxrjones/following{/other_user}",
                "gists_url": "https://api.github.com/users/maxrjones/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/maxrjones",
                "id": 14077947,
                "login": "maxrjones",
                "node_id": "MDQ6VXNlcjE0MDc3OTQ3",
                "organizations_url": "https://api.github.com/users/maxrjones/orgs",
                "received_events_url": "https://api.github.com/users/maxrjones/received_events",
                "repos_url": "https://api.github.com/users/maxrjones/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/maxrjones/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/maxrjones/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/maxrjones"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Closed by #5885 ",
            "created_at": "2021-10-21T19:59:18Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/issues/5882#issuecomment-948958176",
            "id": 948958176,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5882",
            "node_id": "IC_kwDOCJzWHc44j_Pg",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/948958176/reactions"
            },
            "updated_at": "2021-10-21T19:59:18Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/948958176",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/14077947?v=4",
                "events_url": "https://api.github.com/users/maxrjones/events{/privacy}",
                "followers_url": "https://api.github.com/users/maxrjones/followers",
                "following_url": "https://api.github.com/users/maxrjones/following{/other_user}",
                "gists_url": "https://api.github.com/users/maxrjones/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/maxrjones",
                "id": 14077947,
                "login": "maxrjones",
                "node_id": "MDQ6VXNlcjE0MDc3OTQ3",
                "organizations_url": "https://api.github.com/users/maxrjones/orgs",
                "received_events_url": "https://api.github.com/users/maxrjones/received_events",
                "repos_url": "https://api.github.com/users/maxrjones/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/maxrjones/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/maxrjones/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/maxrjones"
            }
        }
    ],
    "comments_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5882/comments",
    "created_at": "2021-10-20T20:58:34Z",
    "events_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5882/events",
    "html_url": "https://github.com/GenericMappingTools/gmt/issues/5882",
    "id": 1031824625,
    "labels": [
        {
            "color": "d73a4a",
            "default": true,
            "description": "Something isn't working",
            "id": 1022239695,
            "name": "bug",
            "node_id": "MDU6TGFiZWwxMDIyMjM5Njk1",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/labels/bug"
        }
    ],
    "labels_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5882/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOCJzWHc49gGTx",
    "number": 5882,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5882/reactions"
    },
    "repository_url": "https://api.github.com/repos/GenericMappingTools/gmt",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5882/timeline",
    "title": "grdtrack issues with virtual files",
    "updated_at": "2021-10-21T19:59:18Z",
    "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5882",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/14077947?v=4",
        "events_url": "https://api.github.com/users/maxrjones/events{/privacy}",
        "followers_url": "https://api.github.com/users/maxrjones/followers",
        "following_url": "https://api.github.com/users/maxrjones/following{/other_user}",
        "gists_url": "https://api.github.com/users/maxrjones/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/maxrjones",
        "id": 14077947,
        "login": "maxrjones",
        "node_id": "MDQ6VXNlcjE0MDc3OTQ3",
        "organizations_url": "https://api.github.com/users/maxrjones/orgs",
        "received_events_url": "https://api.github.com/users/maxrjones/received_events",
        "repos_url": "https://api.github.com/users/maxrjones/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/maxrjones/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/maxrjones/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/maxrjones"
    }
}