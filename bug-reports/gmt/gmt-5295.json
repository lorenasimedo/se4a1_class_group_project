{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "body": "If I generate a geodesic circle with 100 km radius with Proj and compute the distance with ``mpapproject -L`` I get variable distances like this and all considerable different from 100 km.\r\n(We also get an WARNING that should be there)\r\n```\r\njulia> Ddist = mapproject(c, L=(line=[0 0], unit=:e), j=:e, par=(PROJ_ELLIPSOID=\"WGS-84\",), Vd=1)\r\n        mapproject  --PROJ_ELLIPSOID=WGS-84 -je -L+ue\r\nmapproject [WARNING]: Your distance mode (Great Circle) differs from your -j option (Geodesic) which takes precedence.\r\nVector{GMT.GMTdataset} with 1 segments\r\nFirst segment DATA\r\n36\u00d75 Matrix{Float64}:\r\n  0.0        0.904369   99330.7  0.0  0.0\r\n  0.160413   0.889834   99352.1  0.0  0.0\r\n  0.315668   0.846697   99413.6  0.0  0.0\r\n  0.460773   0.776346   99507.2  0.0  0.0\r\n  0.591064   0.681042   99621.0  0.0  0.0\r\n  0.702354   0.563851   99740.3  0.0  0.0\r\n  0.791067   0.428539   99850.1  0.0  0.0\r\n  0.854355   0.279455   99936.3  0.0  0.0\r\n  0.890187   0.121392   99988.0  0.0  0.0\r\n  0.897411  -0.0405727  99998.7  0.0  0.0\r\n  0.875796  -0.201233   99967.0  0.0  0.0\r\n  0.826036  -0.355427   99896.9  0.0  0.0\r\n```\r\ntaking just the first point in my Matlab Vincenty function I get it very close and most of the difference is probably due to truncation in input\r\n```\r\n>> vdist(0.904369,0,0,0)\r\n\r\nans =\r\n\r\n          100000.030638943\r\n``` \r\n\r\nIf I use ``project -Z`` I also cannot recover the input circle radius with any **-j** option. Here the case is more fuzzy because ``project`` computes only spherical circles and it's not obvious that **-jg** is doing the same sphere, though I would expect so. \r\n```\r\nproject  -o0,1 -C0/0 -G10 -Z200 > circ.dat\r\nmapproject -Lpt.dat+ue circ.dat\r\n5.50104544457e-17       0.89831528412   98776.2018419   0       0\r\n-0.0447809811942        0.897198516113  98778.9802858   0       0\r\n-0.0894505753527        0.893850990596  98787.287538    0       0\r\n...\r\n```",
    "closed_at": "2021-06-06T00:42:27Z",
    "closed_by": {
        "avatar_url": "https://avatars.githubusercontent.com/u/26473567?v=4",
        "events_url": "https://api.github.com/users/PaulWessel/events{/privacy}",
        "followers_url": "https://api.github.com/users/PaulWessel/followers",
        "following_url": "https://api.github.com/users/PaulWessel/following{/other_user}",
        "gists_url": "https://api.github.com/users/PaulWessel/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/PaulWessel",
        "id": 26473567,
        "login": "PaulWessel",
        "node_id": "MDQ6VXNlcjI2NDczNTY3",
        "organizations_url": "https://api.github.com/users/PaulWessel/orgs",
        "received_events_url": "https://api.github.com/users/PaulWessel/received_events",
        "repos_url": "https://api.github.com/users/PaulWessel/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/PaulWessel/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/PaulWessel/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/PaulWessel"
    },
    "comments": 14,
    "comments_content": [
        {
            "author_association": "MEMBER",
            "body": "Hm, I do not think so, it least not based on this.\r\n\r\n1. Your circle is no circle but a polygon of n vertices.  So **-L** will find the shortest path from (0,0) to the _mid-point_ of all those cords, never to your vertices.  I bet if you more densely sample your proj circle the closer you will get.  But all the imaginary points on that polygon between your points are always closer than your vertices. We take each pair of vertices to define a great circle and then find crossing with the orthogonal great circle from your point.  I know they in reality are meant to be a small circle in your case but that is not what mapproject knows.\r\n2. Distance from 0,0 to your first vertex is 100000.030639 via `echo 0 0 | gmt mapproject -G0/0.904369+ue --PROJ_ELLIPSOID=WGS-84 -je`, i.e. same as you since the same algorithm.\r\n3. Not sure about **project -Z** yet though.\r\n",
            "created_at": "2021-06-04T15:29:41Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/issues/5295#issuecomment-854815992",
            "id": 854815992,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5295",
            "node_id": "MDEyOklzc3VlQ29tbWVudDg1NDgxNTk5Mg==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/854815992/reactions"
            },
            "updated_at": "2021-06-04T15:30:35Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/854815992",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/26473567?v=4",
                "events_url": "https://api.github.com/users/PaulWessel/events{/privacy}",
                "followers_url": "https://api.github.com/users/PaulWessel/followers",
                "following_url": "https://api.github.com/users/PaulWessel/following{/other_user}",
                "gists_url": "https://api.github.com/users/PaulWessel/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/PaulWessel",
                "id": 26473567,
                "login": "PaulWessel",
                "node_id": "MDQ6VXNlcjI2NDczNTY3",
                "organizations_url": "https://api.github.com/users/PaulWessel/orgs",
                "received_events_url": "https://api.github.com/users/PaulWessel/received_events",
                "repos_url": "https://api.github.com/users/PaulWessel/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/PaulWessel/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/PaulWessel/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/PaulWessel"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Hmm, we'll continue this later tonight or tomorrow (going to Lisbon), some comments.\r\n\r\n1. Increasing the number of points in the polygonal circle made no sensible difference. \r\n2. I have now a pure Geodetic buffer function, which only ArcGIS has and even it it's not clear that it works for line segments. A zoom of my test case where a polyline does a tour around the pole and returns is shown bellow. The points are the remaining vertices after having made the union of many geodetic circles. I used some cheap statistic to remove the missing dots. Ideally, only the central dot of each group should be  retained ant that is what I was expecting the -L could provide.\r\nhttps://github.com/GenericMappingTools/GMT.jl/blob/master/src/proj_utils.jl#L210\r\n\r\n```\r\njulia> D = buffergeo(\"laco_polar.dat\", width=111100*2);\r\nd_mean = 217093.77531789374\r\n```\r\nAs you can see the buffer with is ``222200`` meters but the average distance given by ``mapproject -L`` is 217093\r\n(maximum distance is 223669.24062684373)\r\n\r\nzooming in that image you can see a red line which is the Matlab solution but this one is spherical only and the differences are tinny here but significantly larger at high latitudes. \r\n\r\n![GMTjl_tmp](https://user-images.githubusercontent.com/537321/120832365-7d9a7300-c558-11eb-9f5a-f8ca2cea59f2.png)\r\n",
            "created_at": "2021-06-04T16:20:07Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/issues/5295#issuecomment-854853448",
            "id": 854853448,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5295",
            "node_id": "MDEyOklzc3VlQ29tbWVudDg1NDg1MzQ0OA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/854853448/reactions"
            },
            "updated_at": "2021-06-04T16:20:07Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/854853448",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/537321?v=4",
                "events_url": "https://api.github.com/users/joa-quim/events{/privacy}",
                "followers_url": "https://api.github.com/users/joa-quim/followers",
                "following_url": "https://api.github.com/users/joa-quim/following{/other_user}",
                "gists_url": "https://api.github.com/users/joa-quim/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/joa-quim",
                "id": 537321,
                "login": "joa-quim",
                "node_id": "MDQ6VXNlcjUzNzMyMQ==",
                "organizations_url": "https://api.github.com/users/joa-quim/orgs",
                "received_events_url": "https://api.github.com/users/joa-quim/received_events",
                "repos_url": "https://api.github.com/users/joa-quim/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/joa-quim/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/joa-quim/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/joa-quim"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "The **project -Z** is doing a poor-man's ellipse by creating a Cartesian one in an azimuthal equal area projection centered on the point and project back.  However, for a degenerate one (circle) I can certainly do an exact small circle instead via spherical trig.  Not sure if I know how to generate a spherical ellipse without the lazy projection trick though.\r\nI will work on a branch that does the circle correctly.",
            "created_at": "2021-06-04T18:55:07Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/issues/5295#issuecomment-854937174",
            "id": 854937174,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5295",
            "node_id": "MDEyOklzc3VlQ29tbWVudDg1NDkzNzE3NA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/854937174/reactions"
            },
            "updated_at": "2021-06-04T18:55:07Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/854937174",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/26473567?v=4",
                "events_url": "https://api.github.com/users/PaulWessel/events{/privacy}",
                "followers_url": "https://api.github.com/users/PaulWessel/followers",
                "following_url": "https://api.github.com/users/PaulWessel/following{/other_user}",
                "gists_url": "https://api.github.com/users/PaulWessel/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/PaulWessel",
                "id": 26473567,
                "login": "PaulWessel",
                "node_id": "MDQ6VXNlcjI2NDczNTY3",
                "organizations_url": "https://api.github.com/users/PaulWessel/orgs",
                "received_events_url": "https://api.github.com/users/PaulWessel/received_events",
                "repos_url": "https://api.github.com/users/PaulWessel/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/PaulWessel/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/PaulWessel/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/PaulWessel"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I got [equations](https://math.stackexchange.com/questions/903368/ellipse-like-on-sphere) for spherical ellipses now should be able to implement this in GMT. Just need to translate/rotate the ellipse to where it should go.",
            "created_at": "2021-06-04T19:13:45Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/issues/5295#issuecomment-854946450",
            "id": 854946450,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5295",
            "node_id": "MDEyOklzc3VlQ29tbWVudDg1NDk0NjQ1MA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/854946450/reactions"
            },
            "updated_at": "2021-06-04T19:13:45Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/854946450",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/26473567?v=4",
                "events_url": "https://api.github.com/users/PaulWessel/events{/privacy}",
                "followers_url": "https://api.github.com/users/PaulWessel/followers",
                "following_url": "https://api.github.com/users/PaulWessel/following{/other_user}",
                "gists_url": "https://api.github.com/users/PaulWessel/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/PaulWessel",
                "id": 26473567,
                "login": "PaulWessel",
                "node_id": "MDQ6VXNlcjI2NDczNTY3",
                "organizations_url": "https://api.github.com/users/PaulWessel/orgs",
                "received_events_url": "https://api.github.com/users/PaulWessel/received_events",
                "repos_url": "https://api.github.com/users/PaulWessel/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/PaulWessel/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/PaulWessel/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/PaulWessel"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Note that you may need to set **PROJ_ELLIPSOID**=Sphere for things to make sense since we are doing spherical calculations in -L and -Z.",
            "created_at": "2021-06-05T06:09:08Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/issues/5295#issuecomment-855190730",
            "id": 855190730,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5295",
            "node_id": "MDEyOklzc3VlQ29tbWVudDg1NTE5MDczMA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/855190730/reactions"
            },
            "updated_at": "2021-06-05T06:09:08Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/855190730",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/26473567?v=4",
                "events_url": "https://api.github.com/users/PaulWessel/events{/privacy}",
                "followers_url": "https://api.github.com/users/PaulWessel/followers",
                "following_url": "https://api.github.com/users/PaulWessel/following{/other_user}",
                "gists_url": "https://api.github.com/users/PaulWessel/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/PaulWessel",
                "id": 26473567,
                "login": "PaulWessel",
                "node_id": "MDQ6VXNlcjI2NDczNTY3",
                "organizations_url": "https://api.github.com/users/PaulWessel/orgs",
                "received_events_url": "https://api.github.com/users/PaulWessel/received_events",
                "repos_url": "https://api.github.com/users/PaulWessel/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/PaulWessel/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/PaulWessel/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/PaulWessel"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "See this. The figure shows just the first segment and the mean distance from points to line is ~800 meters wrong. Note that the center line is a great circle in an ellipsoidal earth and from what you said ``mapproject -L`` connects the points of the center line by small circles, but the difference from both seems to be too small to explain the numbers provided by ``mapproject``.\r\n```\r\njulia> D = buffergeo(\"laco_polar.dat\", width=222000);\r\nmapproject [WARNING]: Your distance mode (Great Circle) differs from your -j option (Geodesic) which takes precedence.\r\nd_mean = 221197.1921326989\r\n```\r\n![GMTjl_tmp](https://user-images.githubusercontent.com/537321/120901391-73e53e00-c632-11eb-93b2-aefb7a8292c6.png)\r\n",
            "created_at": "2021-06-05T18:16:50Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/issues/5295#issuecomment-855276653",
            "id": 855276653,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5295",
            "node_id": "MDEyOklzc3VlQ29tbWVudDg1NTI3NjY1Mw==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/855276653/reactions"
            },
            "updated_at": "2021-06-05T18:16:50Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/855276653",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/537321?v=4",
                "events_url": "https://api.github.com/users/joa-quim/events{/privacy}",
                "followers_url": "https://api.github.com/users/joa-quim/followers",
                "following_url": "https://api.github.com/users/joa-quim/following{/other_user}",
                "gists_url": "https://api.github.com/users/joa-quim/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/joa-quim",
                "id": 537321,
                "login": "joa-quim",
                "node_id": "MDQ6VXNlcjUzNzMyMQ==",
                "organizations_url": "https://api.github.com/users/joa-quim/orgs",
                "received_events_url": "https://api.github.com/users/joa-quim/received_events",
                "repos_url": "https://api.github.com/users/joa-quim/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/joa-quim/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/joa-quim/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/joa-quim"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "**mapproject -L** does not do anything using small circles - that would require a pole and a colatitude.  Everything is great circles.  Sorry, what is the gmt command being run here?\r\n",
            "created_at": "2021-06-05T19:02:23Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/issues/5295#issuecomment-855282144",
            "id": 855282144,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5295",
            "node_id": "MDEyOklzc3VlQ29tbWVudDg1NTI4MjE0NA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/855282144/reactions"
            },
            "updated_at": "2021-06-05T19:02:23Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/855282144",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/26473567?v=4",
                "events_url": "https://api.github.com/users/PaulWessel/events{/privacy}",
                "followers_url": "https://api.github.com/users/PaulWessel/followers",
                "following_url": "https://api.github.com/users/PaulWessel/following{/other_user}",
                "gists_url": "https://api.github.com/users/PaulWessel/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/PaulWessel",
                "id": 26473567,
                "login": "PaulWessel",
                "node_id": "MDQ6VXNlcjI2NDczNTY3",
                "organizations_url": "https://api.github.com/users/PaulWessel/orgs",
                "received_events_url": "https://api.github.com/users/PaulWessel/received_events",
                "repos_url": "https://api.github.com/users/PaulWessel/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/PaulWessel/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/PaulWessel/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/PaulWessel"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "For this test image I added these lines\r\n```\r\n\t\tif (n==1)\r\n\t\t\tplot(D, proj=:merc, marker=:p)\r\n\t\t\tplot!(seg, marker=:p, lw=0.1, show=1)\r\n\t\t\tDdist2line = mapproject(D, L=(line=seg, unit=:e), j=:e)\r\n\t\t\td_mean = mean(view(Ddist2line[1].data, :, 3))\r\n\t\t\t@show(d_mean)\r\n\t\tend\r\n```\r\nafter\r\nhttps://github.com/GenericMappingTools/GMT.jl/blob/master/src/proj_utils.jl#L238\r\n\r\nFor you to reproduce it you need to update GMT.jl (master) and run something like this\r\n\r\n```\r\nD = buffergeo([0.0 0; 5 5], width=111111);\r\nDdist2line = mapproject(D, L=(line=[0. 0; 5 5], unit=:e), j=:e)\r\nd_mean = mean(Ddist2line[1].data[:, 3])\r\n```\r\nand that gives\r\n\r\nd_mean = 110724.60981662398",
            "created_at": "2021-06-05T19:31:20Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/issues/5295#issuecomment-855285350",
            "id": 855285350,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5295",
            "node_id": "MDEyOklzc3VlQ29tbWVudDg1NTI4NTM1MA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/855285350/reactions"
            },
            "updated_at": "2021-06-05T19:33:19Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/855285350",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/537321?v=4",
                "events_url": "https://api.github.com/users/joa-quim/events{/privacy}",
                "followers_url": "https://api.github.com/users/joa-quim/followers",
                "following_url": "https://api.github.com/users/joa-quim/following{/other_user}",
                "gists_url": "https://api.github.com/users/joa-quim/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/joa-quim",
                "id": 537321,
                "login": "joa-quim",
                "node_id": "MDQ6VXNlcjUzNzMyMQ==",
                "organizations_url": "https://api.github.com/users/joa-quim/orgs",
                "received_events_url": "https://api.github.com/users/joa-quim/received_events",
                "repos_url": "https://api.github.com/users/joa-quim/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/joa-quim/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/joa-quim/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/joa-quim"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Checking that you are using **--PROJ_ELLIPSOID**=Sphere when you do these things since otherwise you get a mix of ellipsoidal and spherical results and they will easily give things like 100m to several km misfits.  We may in fact need **mapproject** to set things to sphere when spherical calculations are done.  Remember, unless sphere is set we pick an _authalic_ mean sphere radius and use auxiliary latitudes, so cannot possibly match ellipsoidal results, or results run with --PROJ_ELLIPSOID=Sphere:\r\n\r\n`mapproject [DEBUG]: Map distance calculation will be using great circle approximation with authalic auxiliary latitudes and authalic (R_2) radius = 6371008.7714 m, in meter.`\r\n",
            "created_at": "2021-06-05T19:43:18Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/issues/5295#issuecomment-855286625",
            "id": 855286625,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5295",
            "node_id": "MDEyOklzc3VlQ29tbWVudDg1NTI4NjYyNQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/855286625/reactions"
            },
            "updated_at": "2021-06-05T19:43:18Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/855286625",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/26473567?v=4",
                "events_url": "https://api.github.com/users/PaulWessel/events{/privacy}",
                "followers_url": "https://api.github.com/users/PaulWessel/followers",
                "following_url": "https://api.github.com/users/PaulWessel/following{/other_user}",
                "gists_url": "https://api.github.com/users/PaulWessel/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/PaulWessel",
                "id": 26473567,
                "login": "PaulWessel",
                "node_id": "MDQ6VXNlcjI2NDczNTY3",
                "organizations_url": "https://api.github.com/users/PaulWessel/orgs",
                "received_events_url": "https://api.github.com/users/PaulWessel/received_events",
                "repos_url": "https://api.github.com/users/PaulWessel/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/PaulWessel/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/PaulWessel/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/PaulWessel"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I don\u2019t want sphere  I want ellipsoid and so I\u2019m using -je which is supposed to use ellipsoid, not authalic sphere which is the default -jg \r\n(All this from memory since I\u2019m writing from the phone). ",
            "created_at": "2021-06-05T20:00:36Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/issues/5295#issuecomment-855288564",
            "id": 855288564,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5295",
            "node_id": "MDEyOklzc3VlQ29tbWVudDg1NTI4ODU2NA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/855288564/reactions"
            },
            "updated_at": "2021-06-05T20:00:36Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/855288564",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/537321?v=4",
                "events_url": "https://api.github.com/users/joa-quim/events{/privacy}",
                "followers_url": "https://api.github.com/users/joa-quim/followers",
                "following_url": "https://api.github.com/users/joa-quim/following{/other_user}",
                "gists_url": "https://api.github.com/users/joa-quim/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/joa-quim",
                "id": 537321,
                "login": "joa-quim",
                "node_id": "MDQ6VXNlcjUzNzMyMQ==",
                "organizations_url": "https://api.github.com/users/joa-quim/orgs",
                "received_events_url": "https://api.github.com/users/joa-quim/received_events",
                "repos_url": "https://api.github.com/users/joa-quim/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/joa-quim/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/joa-quim/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/joa-quim"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I understand, but you probably also understand that GMT does not support intersections of geodesics etc, only great circles.  So there is no way in GMT to get an ellipsoidal -L result.  You could probably get the nearest points and then use mapproject -G (which does support geodesics) and get improved numbers.",
            "created_at": "2021-06-05T20:19:14Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/issues/5295#issuecomment-855290666",
            "id": 855290666,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5295",
            "node_id": "MDEyOklzc3VlQ29tbWVudDg1NTI5MDY2Ng==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/855290666/reactions"
            },
            "updated_at": "2021-06-05T20:19:14Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/855290666",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/26473567?v=4",
                "events_url": "https://api.github.com/users/PaulWessel/events{/privacy}",
                "followers_url": "https://api.github.com/users/PaulWessel/followers",
                "following_url": "https://api.github.com/users/PaulWessel/following{/other_user}",
                "gists_url": "https://api.github.com/users/PaulWessel/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/PaulWessel",
                "id": 26473567,
                "login": "PaulWessel",
                "node_id": "MDQ6VXNlcjI2NDczNTY3",
                "organizations_url": "https://api.github.com/users/PaulWessel/orgs",
                "received_events_url": "https://api.github.com/users/PaulWessel/received_events",
                "repos_url": "https://api.github.com/users/PaulWessel/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/PaulWessel/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/PaulWessel/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/PaulWessel"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "OK, but then we should not allow **-L** and **-je** together because that was the source of this misunderstanding \r\n\r\n> -je to select ellipsoidal (or geodesic) mode for the highest precision and slowest calculation time.",
            "created_at": "2021-06-05T22:59:11Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/issues/5295#issuecomment-855307257",
            "id": 855307257,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5295",
            "node_id": "MDEyOklzc3VlQ29tbWVudDg1NTMwNzI1Nw==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/855307257/reactions"
            },
            "updated_at": "2021-06-05T22:59:11Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/855307257",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/537321?v=4",
                "events_url": "https://api.github.com/users/joa-quim/events{/privacy}",
                "followers_url": "https://api.github.com/users/joa-quim/followers",
                "following_url": "https://api.github.com/users/joa-quim/following{/other_user}",
                "gists_url": "https://api.github.com/users/joa-quim/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/joa-quim",
                "id": 537321,
                "login": "joa-quim",
                "node_id": "MDQ6VXNlcjUzNzMyMQ==",
                "organizations_url": "https://api.github.com/users/joa-quim/orgs",
                "received_events_url": "https://api.github.com/users/joa-quim/received_events",
                "repos_url": "https://api.github.com/users/joa-quim/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/joa-quim/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/joa-quim/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/joa-quim"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I agree, and there may be other things like this.",
            "created_at": "2021-06-05T23:03:40Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/issues/5295#issuecomment-855307675",
            "id": 855307675,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5295",
            "node_id": "MDEyOklzc3VlQ29tbWVudDg1NTMwNzY3NQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/855307675/reactions"
            },
            "updated_at": "2021-06-05T23:03:40Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/855307675",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/26473567?v=4",
                "events_url": "https://api.github.com/users/PaulWessel/events{/privacy}",
                "followers_url": "https://api.github.com/users/PaulWessel/followers",
                "following_url": "https://api.github.com/users/PaulWessel/following{/other_user}",
                "gists_url": "https://api.github.com/users/PaulWessel/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/PaulWessel",
                "id": 26473567,
                "login": "PaulWessel",
                "node_id": "MDQ6VXNlcjI2NDczNTY3",
                "organizations_url": "https://api.github.com/users/PaulWessel/orgs",
                "received_events_url": "https://api.github.com/users/PaulWessel/received_events",
                "repos_url": "https://api.github.com/users/PaulWessel/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/PaulWessel/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/PaulWessel/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/PaulWessel"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Much closer now\r\n```\r\njulia> D = buffergeo([0.0 0; 5 5], width=111111, proj=\"+proj=longlat +a=6371000 +b=6371000 +no_defs\", tol=0);\r\njulia> Ddist2line = mapproject(D, L=(line=[0. 0; 5 5], unit=:e), par=(PROJ_ELLIPSOID=6371000,));\r\njulia> d_mean = mean(Ddist2line[1].data[:, 3])\r\n111047.51072930203\r\n```\r\nThe ``tol=0`` above means no DP line simplification so the union of all circles is still a bit wiggling. Letting the automatic DP tolerance do it's job\r\n```\r\njulia> D = buffergeo([0.0 0; 5 5], width=111111, proj=\"+proj=longlat +a=6371000 +b=6371000 +no_defs\");\r\njulia> Ddist2line = mapproject(D, L=(line=[0. 0; 5 5], unit=:e), par=(PROJ_ELLIPSOID=6371000,));\r\njulia> d_mean = mean(Ddist2line[1].data[:, 3])\r\n111061.86224631214\r\n```\r\nslightly improves the result and is visually more appealing. I guess this is the limit of my method until I find a way to detect which point of each circle is exactly at the buffer width distance from the line.",
            "created_at": "2021-06-05T23:23:22Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/issues/5295#issuecomment-855309493",
            "id": 855309493,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5295",
            "node_id": "MDEyOklzc3VlQ29tbWVudDg1NTMwOTQ5Mw==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/855309493/reactions"
            },
            "updated_at": "2021-06-05T23:23:22Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/855309493",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/537321?v=4",
                "events_url": "https://api.github.com/users/joa-quim/events{/privacy}",
                "followers_url": "https://api.github.com/users/joa-quim/followers",
                "following_url": "https://api.github.com/users/joa-quim/following{/other_user}",
                "gists_url": "https://api.github.com/users/joa-quim/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/joa-quim",
                "id": 537321,
                "login": "joa-quim",
                "node_id": "MDQ6VXNlcjUzNzMyMQ==",
                "organizations_url": "https://api.github.com/users/joa-quim/orgs",
                "received_events_url": "https://api.github.com/users/joa-quim/received_events",
                "repos_url": "https://api.github.com/users/joa-quim/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/joa-quim/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/joa-quim/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/joa-quim"
            }
        }
    ],
    "comments_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5295/comments",
    "created_at": "2021-06-04T11:01:44Z",
    "events_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5295/events",
    "html_url": "https://github.com/GenericMappingTools/gmt/issues/5295",
    "id": 911388031,
    "labels": [
        {
            "color": "d73a4a",
            "default": true,
            "description": "Something isn't working",
            "id": 1022239695,
            "name": "bug",
            "node_id": "MDU6TGFiZWwxMDIyMjM5Njk1",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/labels/bug"
        }
    ],
    "labels_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5295/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWU5MTEzODgwMzE=",
    "number": 5295,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5295/reactions"
    },
    "repository_url": "https://api.github.com/repos/GenericMappingTools/gmt",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5295/timeline",
    "title": "Something's wrong with distances calculation in mapproject -L",
    "updated_at": "2021-06-06T00:42:27Z",
    "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/5295",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/537321?v=4",
        "events_url": "https://api.github.com/users/joa-quim/events{/privacy}",
        "followers_url": "https://api.github.com/users/joa-quim/followers",
        "following_url": "https://api.github.com/users/joa-quim/following{/other_user}",
        "gists_url": "https://api.github.com/users/joa-quim/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/joa-quim",
        "id": 537321,
        "login": "joa-quim",
        "node_id": "MDQ6VXNlcjUzNzMyMQ==",
        "organizations_url": "https://api.github.com/users/joa-quim/orgs",
        "received_events_url": "https://api.github.com/users/joa-quim/received_events",
        "repos_url": "https://api.github.com/users/joa-quim/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/joa-quim/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/joa-quim/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/joa-quim"
    }
}