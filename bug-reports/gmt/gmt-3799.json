{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "body": "This addresses issue #3694.  The problem turned out to be this:\r\n\r\n**grdimage** usually reads in a grid in two steps:\r\n\r\n1. Read in the grid header only to determine the grid region\r\n2. After calling _gmt_map_setup_, which may adjust **-R** for global grids, we read the grid, this time passing the adjusted wesn for the map.\r\n\r\nSo, in the case that caused this issue, we may use -Rg and -JN120/20c, but after _gmt_map_setup_, the R.wesn is no longer 0/30 but -60/300.  So the grid is read in correctly relative to the desired region.\r\n\r\nHowever, when we read a global tiled region there is a difference: Because the grid is assembled by **grdblend**, the first call (to get the header) needs to do the whole thing since we are not going to assemble the grid twice just to be the region.  Thus, the tiled region in this case remains 0/360 since there is no second read after projection is set.  Nevertheless, none of this caused a problem until we also selected auto-shading.  Now, the 0/360 grid is passed to **grdgradient** with the actual region and two grids are out of sync.\r\n\r\nThere may be more than one solution to this.  Since this case is unique to **grdimage** the following solution was implemented there: Since we know we read a tiled_grid up front in this specific case (tiled grid + auto-shading) we simply pass the 0/360 region to **grdgradient** rather than the adjusted region.  With that change, the case works and all tests work fine.\r\n",
    "closed_at": "2020-08-01T07:37:29Z",
    "closed_by": {
        "avatar_url": "https://avatars.githubusercontent.com/u/26473567?v=4",
        "events_url": "https://api.github.com/users/PaulWessel/events{/privacy}",
        "followers_url": "https://api.github.com/users/PaulWessel/followers",
        "following_url": "https://api.github.com/users/PaulWessel/following{/other_user}",
        "gists_url": "https://api.github.com/users/PaulWessel/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/PaulWessel",
        "id": 26473567,
        "login": "PaulWessel",
        "node_id": "MDQ6VXNlcjI2NDczNTY3",
        "organizations_url": "https://api.github.com/users/PaulWessel/orgs",
        "received_events_url": "https://api.github.com/users/PaulWessel/received_events",
        "repos_url": "https://api.github.com/users/PaulWessel/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/PaulWessel/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/PaulWessel/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/PaulWessel"
    },
    "comments": 3,
    "comments_content": [
        {
            "author_association": "CONTRIBUTOR",
            "body": "The backport to `6.1` failed:\n```\nThe process 'git' failed with exit code 1\n```\nTo backport manually, run these commands in your terminal:\n```bash\n# Fetch latest updates from GitHub\ngit fetch\n# Create a new working tree\ngit worktree add .worktrees/backport-6.1 6.1\n# Navigate to the new working tree\ncd .worktrees/backport-6.1\n# Create a new branch\ngit switch --create backport-3799-to-6.1\n# Cherry-pick the merged commit of this pull request and resolve the conflicts\ngit cherry-pick a336215a12b9d879f6cf097b1bd96f54706ab658\n# Push it to GitHub\ngit push --set-upstream origin backport-3799-to-6.1\n# Go back to the original working tree\ncd ../..\n# Delete the working tree\ngit worktree remove .worktrees/backport-6.1\n```\nThen, create a pull request where the `base` branch is `6.1` and the `compare`/`head` branch is `backport-3799-to-6.1`.",
            "created_at": "2020-08-01T07:38:15Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/pull/3799#issuecomment-667489423",
            "id": 667489423,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/3799",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY2NzQ4OTQyMw==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/667489423/reactions"
            },
            "updated_at": "2020-08-01T07:38:15Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/667489423",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
                "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
                "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
                "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
                "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/apps/github-actions",
                "id": 41898282,
                "login": "github-actions[bot]",
                "node_id": "MDM6Qm90NDE4OTgyODI=",
                "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
                "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
                "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
                "type": "Bot",
                "url": "https://api.github.com/users/github-actions%5Bbot%5D"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Maybe have a look at this tomorrow, @seisman ",
            "created_at": "2020-08-01T07:39:27Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/pull/3799#issuecomment-667489548",
            "id": 667489548,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/3799",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY2NzQ4OTU0OA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/667489548/reactions"
            },
            "updated_at": "2020-08-01T07:39:27Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/667489548",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/26473567?v=4",
                "events_url": "https://api.github.com/users/PaulWessel/events{/privacy}",
                "followers_url": "https://api.github.com/users/PaulWessel/followers",
                "following_url": "https://api.github.com/users/PaulWessel/following{/other_user}",
                "gists_url": "https://api.github.com/users/PaulWessel/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/PaulWessel",
                "id": 26473567,
                "login": "PaulWessel",
                "node_id": "MDQ6VXNlcjI2NDczNTY3",
                "organizations_url": "https://api.github.com/users/PaulWessel/orgs",
                "received_events_url": "https://api.github.com/users/PaulWessel/received_events",
                "repos_url": "https://api.github.com/users/PaulWessel/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/PaulWessel/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/PaulWessel/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/PaulWessel"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "There is a conflict in grdimage.c when cherry-picking this PR:\r\n```diff\r\n++<<<<<<< HEAD\r\n +              /* Prepare the grdgradient arguments using selected -A -N and the data region in effect */\r\n +              sprintf (cmd, \"-G%s -A%s -N%s+a%s -R%.16g/%.16g/%.16g/%.16g --GMT_HISTORY=false \",\r\n +                      int_grd, Ctrl->I.azimuth, Ctrl->I.method, Ctrl->I.ambient, wesn[XLO], wesn[XHI], wesn[YLO], wesn[YHI]);\r\n +              if (got_data_grid)      /* Use the virtual file we made earlier */\r\n++=======\r\n+               /* Prepare the grdgradient arguments using selected -A -N and the data region in effect.  If we read in a tiled grid\r\n+                * then it was made with 0/360 so we must use that region in grdgradient.  For non-tiles, we read the actual grid\r\n+                * AFTER calling gmt_mapsetup which changes the region.  The tiled region remains unchanged because it is read in\r\n+                * all at once as it is being assembled.  This fixes https://github.com/GenericMappingTools/gmt/issues/3694 */\r\n+               sprintf (cmd, \"-G%s -A%s -N%s+a%s -R%.16g/%.16g/%.16g/%.16g --GMT_HISTORY=readonly \",\r\n+                       int_grd, Ctrl->I.azimuth, Ctrl->I.method, Ctrl->I.ambient, region[XLO], region[XHI], region[YLO], region[YHI]);\r\n+               if (got_data_tiles)     /* Use the virtual file we made earlier */\r\n++>>>>>>> a336215a12... Special attention when tile grids are passed to grdimage (#3799)\r\n``` \r\nI believe I should accept the changes in the 2nd block, but change `--GMT_HISTORY=readonly` to `--GMT_HISTORY=false` (we didn't backport the GMT_HISTORY changes of https://github.com/GenericMappingTools/gmt/pull/3687 to 6.1 branch).",
            "created_at": "2020-08-01T12:07:21Z",
            "html_url": "https://github.com/GenericMappingTools/gmt/pull/3799#issuecomment-667521470",
            "id": 667521470,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/3799",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY2NzUyMTQ3MA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/667521470/reactions"
            },
            "updated_at": "2020-08-01T12:07:21Z",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/comments/667521470",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3974108?v=4",
                "events_url": "https://api.github.com/users/seisman/events{/privacy}",
                "followers_url": "https://api.github.com/users/seisman/followers",
                "following_url": "https://api.github.com/users/seisman/following{/other_user}",
                "gists_url": "https://api.github.com/users/seisman/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/seisman",
                "id": 3974108,
                "login": "seisman",
                "node_id": "MDQ6VXNlcjM5NzQxMDg=",
                "organizations_url": "https://api.github.com/users/seisman/orgs",
                "received_events_url": "https://api.github.com/users/seisman/received_events",
                "repos_url": "https://api.github.com/users/seisman/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/seisman/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/seisman/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/seisman"
            }
        }
    ],
    "comments_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/3799/comments",
    "created_at": "2020-08-01T05:10:56Z",
    "draft": false,
    "events_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/3799/events",
    "html_url": "https://github.com/GenericMappingTools/gmt/pull/3799",
    "id": 670533293,
    "labels": [
        {
            "color": "d73a4a",
            "default": true,
            "description": "Something isn't working",
            "id": 1022239695,
            "name": "bug",
            "node_id": "MDU6TGFiZWwxMDIyMjM5Njk1",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/labels/bug"
        },
        {
            "color": "000000",
            "default": false,
            "description": "Backport this PR to 6.1 branch",
            "id": 2195437164,
            "name": "backport 6.1",
            "node_id": "MDU6TGFiZWwyMTk1NDM3MTY0",
            "url": "https://api.github.com/repos/GenericMappingTools/gmt/labels/backport%206.1"
        }
    ],
    "labels_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/3799/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NDYwNzkzNzg3",
    "number": 3799,
    "performed_via_github_app": null,
    "pull_request": {
        "diff_url": "https://github.com/GenericMappingTools/gmt/pull/3799.diff",
        "html_url": "https://github.com/GenericMappingTools/gmt/pull/3799",
        "merged_at": "2020-08-01T07:37:29Z",
        "patch_url": "https://github.com/GenericMappingTools/gmt/pull/3799.patch",
        "url": "https://api.github.com/repos/GenericMappingTools/gmt/pulls/3799"
    },
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/3799/reactions"
    },
    "repository_url": "https://api.github.com/repos/GenericMappingTools/gmt",
    "state": "closed",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/3799/timeline",
    "title": "Special attention when tile grids are passed to grdimage",
    "updated_at": "2020-08-01T12:07:21Z",
    "url": "https://api.github.com/repos/GenericMappingTools/gmt/issues/3799",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/26473567?v=4",
        "events_url": "https://api.github.com/users/PaulWessel/events{/privacy}",
        "followers_url": "https://api.github.com/users/PaulWessel/followers",
        "following_url": "https://api.github.com/users/PaulWessel/following{/other_user}",
        "gists_url": "https://api.github.com/users/PaulWessel/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/PaulWessel",
        "id": 26473567,
        "login": "PaulWessel",
        "node_id": "MDQ6VXNlcjI2NDczNTY3",
        "organizations_url": "https://api.github.com/users/PaulWessel/orgs",
        "received_events_url": "https://api.github.com/users/PaulWessel/received_events",
        "repos_url": "https://api.github.com/users/PaulWessel/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/PaulWessel/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/PaulWessel/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/PaulWessel"
    }
}