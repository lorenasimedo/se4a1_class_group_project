{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "body": "**Description of the problem**\r\n\r\nPassing `shading=True` in a simple `fig.grdimage()` call produces an error if the input grid is an `xarray.DataArray`. The error does not appear when I use the special \"@\" filename.\r\n\r\n**Full code that generated the error**\r\n\r\n```python\r\nimport pygmt\r\n\r\nfig = pygmt.Figure()\r\n\r\ndem = pygmt.datasets.load_earth_relief('10m')\r\n\r\nfig.grdimage(dem, region=[-180, 180, -90, 90], frame='af',\r\n             projection='Cyl_stere/6i', cmap='geo', shading=True)\r\n\r\nfig.show(method='external')\r\n```\r\nThis works, though:\r\n\r\n```python\r\nimport pygmt\r\n\r\nfig = pygmt.Figure()\r\n\r\nfig.grdimage('@earth_relief_10m', region=[-180, 180, -90, 90], frame='af',\r\n             projection='Cyl_stere/6i', cmap='geo', shading=True)\r\n\r\nfig.show(method='external')\r\n```\r\n\r\n**Error message summary**\r\n```\r\ngrdimage [ERROR]: Passing max <= zmin prevents automatic CPT generation!\r\ngrdimage [ERROR]: Failed to read CPT geo.\r\n```\r\n\r\n<details>\r\n<summary><b>Full error message (debug verbosity)</b></summary>\r\n<br>\r\n\r\n```\r\ngrdimage [DEBUG]: Map distance calculation will be using great circle approximation with authalic auxiliary latitudes and authalic (R_2) radius = 6371007.1809 m, in meter.\r\ngrdimage [DEBUG]: Look for file -180/180/-90/90 in /Users/liamtoney/.gmt\r\ngrdimage [DEBUG]: Look for file -180/180/-90/90 in /Users/liamtoney/.gmt/cache\r\ngrdimage [DEBUG]: Look for file -180/180/-90/90 in /Users/liamtoney/.gmt/server\r\ngrdimage [DEBUG]: Look for file -180/180/-90/90 in /Users/liamtoney/.gmt/server/srtm1\r\ngrdimage [DEBUG]: Look for file -180/180/-90/90 in /Users/liamtoney/.gmt/server/srtm3\r\ngrdimage [DEBUG]: Got regular w/e/s/n for region (-180/180/-90/90)\r\ngrdimage [DEBUG]: Look for file geo in /Users/liamtoney/.gmt\r\ngrdimage [DEBUG]: Look for file geo in /Users/liamtoney/.gmt/cache\r\ngrdimage [DEBUG]: Look for file geo in /Users/liamtoney/.gmt/server\r\ngrdimage [DEBUG]: Look for file geo in /Users/liamtoney/.gmt/server/srtm1\r\ngrdimage [DEBUG]: Look for file geo in /Users/liamtoney/.gmt/server/srtm3\r\ngrdimage [DEBUG]: Look for file @GMTAPI@-000000 in /Users/liamtoney/.gmt\r\ngrdimage [DEBUG]: Look for file @GMTAPI@-000000 in /Users/liamtoney/.gmt/cache\r\ngrdimage [DEBUG]: Look for file @GMTAPI@-000000 in /Users/liamtoney/.gmt/server\r\ngrdimage [DEBUG]: Look for file @GMTAPI@-000000 in /Users/liamtoney/.gmt/server/srtm1\r\ngrdimage [DEBUG]: Look for file @GMTAPI@-000000 in /Users/liamtoney/.gmt/server/srtm3\r\ngrdimage [INFORMATION]: Read header from file @GMTAPI@-000000\r\ngrdimage [DEBUG]: Local file /Users/liamtoney/.gmt/server/gmt_hash_server.txt found\r\ngrdimage [DEBUG]: File /Users/liamtoney/.gmt/server/gmt_hash_server.txt less than 24 hours old, refresh is premature.\r\ngrdimage [DEBUG]: api_begin_io: Input resource access is now enabled [container]\r\ngrdimage [DEBUG]: api_import_grid: Passed ID = 0 and mode = 1\r\ngrdimage [DEBUG]: Grid/Image dimensions imply w/e/s/n = -180/180/-90/90, inc = 0.166667/0.166667, gridline registration, n_layers = 1\r\ngrdimage [DEBUG]: Geographic input grid, longitudes span exactly 360\r\ngrdimage [INFORMATION]: Given domain implies x_inc = 0.166667\r\ngrdimage [INFORMATION]: Given domain implies y_inc = 0.166667\r\ngrdimage [DEBUG]: Grid is considered to have a 360-degree longitude range.\r\ngrdimage [DEBUG]: Chosen boundary condition for all edges: geographic\r\ngrdimage [DEBUG]: Geographic input grid, longitudes span exactly 360\r\ngrdimage [DEBUG]: Object ID 1 : Registered Grid Memory Reference 7fc1ced29590 as an Input resource with geometry Surface [n_objects = 2]\r\ngrdimage [DEBUG]: Successfully created a new Grid container\r\ngrdimage [DEBUG]: GMT_End_IO: Input resource access is now disabled\r\ngrdimage [WARNING]: Spherical approximation used!\r\ngrdimage [WARNING]: Central meridian not given, default to 0\r\ngrdimage [DEBUG]: Projected values in meters: -2.00151e+07 2.00151e+07 -1.2742e+07 1.2742e+07\r\ngrdimage [DEBUG]: Auto-frame interval for axis 0 item 0: d = 60  f = 15\r\ngrdimage [INFORMATION]: Auto-frame interval for x-axis (item 0): a60f15\r\ngrdimage [DEBUG]: Auto-frame interval for axis 1 item 0: d = 60  f = 15\r\ngrdimage [INFORMATION]: Auto-frame interval for y-axis (item 0): a60f15\r\ngrdimage [INFORMATION]: Map scale is 2626.65 km per cm or 1:2.62665e+08.\r\ngrdimage [DEBUG]: Projected grid is non-orthogonal, nonlinear, or dpi was changed\r\ngrdimage [INFORMATION]: Derive intensity grid from data grid\r\ngrdimage [DEBUG]: Object ID 2 : Registered Grid Memory Copy 7fc1cec5a210 as an Output resource with geometry Surface [n_objects = 3]\r\ngrdimage [DEBUG]: Successfully created a new Grid container\r\ngrdimage [INFORMATION]: Calling grdgradient with args -G@GMTAPI@-000002 -A-45.0 -Nt1 -R-180/180/-90/90 --GMT_HISTORY=false @GMTAPI@-000000\r\ngrdimage [DEBUG]: GMT now running in modern mode [Session ID = 9323]\r\ngrdimage (gmtlib_free_tmp_arrays): tried to free unallocated memory\r\ngrdgradient [DEBUG]: History: Process -R-180/180/-90/90\r\ngrdgradient [DEBUG]: Look for file -180/180/-90/90 in /Users/liamtoney/.gmt\r\ngrdgradient [DEBUG]: Look for file -180/180/-90/90 in /Users/liamtoney/.gmt/cache\r\ngrdgradient [DEBUG]: Look for file -180/180/-90/90 in /Users/liamtoney/.gmt/server\r\ngrdgradient [DEBUG]: Look for file -180/180/-90/90 in /Users/liamtoney/.gmt/server/srtm1\r\ngrdgradient [DEBUG]: Look for file -180/180/-90/90 in /Users/liamtoney/.gmt/server/srtm3\r\ngrdgradient [DEBUG]: Got regular w/e/s/n for region (-180/180/-90/90)\r\ngrdgradient [DEBUG]: Look for file -45.0 in /Users/liamtoney/.gmt\r\ngrdgradient [DEBUG]: Look for file -45.0 in /Users/liamtoney/.gmt/cache\r\ngrdgradient [DEBUG]: Look for file -45.0 in /Users/liamtoney/.gmt/server\r\ngrdgradient [DEBUG]: Look for file -45.0 in /Users/liamtoney/.gmt/server/srtm1\r\ngrdgradient [DEBUG]: Look for file -45.0 in /Users/liamtoney/.gmt/server/srtm3\r\ngrdgradient [DEBUG]: amplitude_set = Y offset_set = N sigma_set = N\r\ngrdgradient [INFORMATION]: Processing input grid\r\ngrdgradient [DEBUG]: api_begin_io: Input resource access is now enabled [container]\r\ngrdgradient [DEBUG]: api_import_grid: Passed ID = 0 and mode = 1\r\ngrdgradient [DEBUG]: Grid/Image dimensions imply w/e/s/n = -180/180/-90/90, inc = 0.166667/0.166667, gridline registration, n_layers = 1\r\ngrdgradient [DEBUG]: Geographic input grid, longitudes span exactly 360\r\ngrdgradient [INFORMATION]: Given domain implies x_inc = 0.166667\r\ngrdgradient [INFORMATION]: Given domain implies y_inc = 0.166667\r\ngrdgradient [DEBUG]: Grid is considered to have a 360-degree longitude range.\r\ngrdgradient [DEBUG]: Chosen boundary condition for all edges: geographic\r\ngrdgradient [DEBUG]: Geographic input grid, longitudes span exactly 360\r\ngrdgradient [DEBUG]: Object ID 3 : Registered Grid Memory Reference 7fc1cc5eb9f0 as an Input resource with geometry Surface [n_objects = 4]\r\ngrdgradient [DEBUG]: Successfully created a new Grid container\r\ngrdgradient [DEBUG]: GMT_End_IO: Input resource access is now disabled\r\ngrdgradient [DEBUG]: api_begin_io: Input resource access is now enabled [container]\r\ngrdgradient [DEBUG]: api_import_grid: Passed ID = 0 and mode = 2\r\ngrdgradient [INFORMATION]: Importing grid data from user memory location\r\ngrdgradient [DEBUG]: Grid is considered to have a 360-degree longitude range.\r\ngrdgradient [DEBUG]: Chosen boundary condition for all edges: geographic\r\ngrdgradient [INFORMATION]: Set boundary condition for top    edge: geographic\r\ngrdgradient [INFORMATION]: Set boundary condition for bottom edge: geographic\r\ngrdgradient [DEBUG]: GMT_End_IO: Input resource access is now disabled\r\ngrdgradient [DEBUG]: Object ID 4 : Registered Grid Memory Reference 7fc1cc5d3850 as an Input resource with geometry Surface [n_objects = 5]\r\ngrdgradient [DEBUG]: Successfully duplicated a Grid\r\ngrdgradient [INFORMATION]:  Min Mean Max sigma intensities:\r\ngrdgradient [INFORMATION]: \t-0.35723270421\t0.000249671630837\t0.283594327547\t0.0132078509689\r\ngrdgradient [DEBUG]: GMT_Write_Data: Writing Grid to memory object 2 from object 4 which transfers ownership\r\ngrdgradient [DEBUG]: api_begin_io: Output resource access is now enabled [container]\r\ngrdgradient [DEBUG]: api_export_data: Messenger dummy output container for object 2 [item 2] freed and set resource=data=NULL\r\ngrdgradient [DEBUG]: api_export_grid: Passed ID = 2 and mode = 0\r\ngrdgradient [INFORMATION]: Referencing grid data to GMT_GRID memory location\r\ngrdgradient [DEBUG]: GMT_End_IO: Output resource access is now disabled\r\ngrdgradient [DEBUG]: gmtapi_garbage_collection: Destroying object: C=0 A=0 ID=3 W=Input F=Grid M=Memory Copy S=Used P=7fc1cc5eb9f0 N=(null)\r\ngrdgradient [DEBUG]: GMTAPI_Garbage_Collection freed 1 memory objects\r\ngrdgradient [DEBUG]: gmtapi_unregister_io: Unregistering object no 3 [n_objects = 4]\r\ngrdgradient [DEBUG]: gmtapi_unregister_io: Unregistering object no 4 [n_objects = 3]\r\ngrdgradient (gmtlib_free_tmp_arrays): tried to free unallocated memory\r\ngrdimage [DEBUG]: Running in PS mode modern\r\ngrdimage [DEBUG]: Use PS filename /Users/liamtoney/.gmt/sessions/gmt6.9323/gmt_8.ps-\r\ngrdimage [DEBUG]: Create hidden PS file /Users/liamtoney/.gmt/sessions/gmt6.9323/gmt_8.ps-\r\ngrdimage [DEBUG]: Got session name as pygmt-session and default graphics formats as pdf\r\ngrdimage [INFORMATION]: Allocate and read data from file @GMTAPI@-000000\r\ngrdimage [DEBUG]: api_begin_io: Input resource access is now enabled [container]\r\ngrdimage [DEBUG]: api_import_grid: Passed ID = 1 and mode = 2\r\ngrdimage [INFORMATION]: Duplicating grid data from GMT_GRID memory location\r\ngrdimage [DEBUG]: GMT_End_IO: Input resource access is now disabled\r\ngrdimage [INFORMATION]: Allocates memory and read intensity file\r\ngrdimage [INFORMATION]: project grid files\r\ngrdimage [DEBUG]: Object ID 5 : Registered Grid Memory Reference 7fc1cc765be0 as an Input resource with geometry Surface [n_objects = 4]\r\ngrdimage [DEBUG]: Successfully duplicated a Grid\r\ngrdimage [DEBUG]: gmt_project_init: IN: Inc [0/0] n_columns/n_rows [2161/1081] dpi = 0 offset = 0\r\ngrdimage [DEBUG]: gmt_project_init: OUT: Inc [0/0] n_columns/n_rows [2161/1081] dpi = 0 offset = 0\r\ngrdimage [INFORMATION]: Grid projection from size 2161x1081 to 2161x1081\r\ngrdimage [DEBUG]: Successfully added data array to previously registered Grid container\r\ngrdimage [DEBUG]: gmt_grd_project: In [-180/180/-90/90] and out [0/6/0/3.81971863421]\r\ngrdimage [DEBUG]: GMT_Destroy_Data: freed memory for a Grid for object 1\r\ngrdimage [DEBUG]: gmtapi_unregister_io: Unregistering object no 1 [n_objects = 3]\r\ngrdimage [DEBUG]: gmtapi_unregister_io: Object no 1 has non-NULL resource pointer\r\ngrdimage [DEBUG]: Object ID 6 : Registered Grid Memory Reference 7fc1cc73a3e0 as an Input resource with geometry Surface [n_objects = 4]\r\ngrdimage [DEBUG]: Successfully duplicated a Grid\r\ngrdimage [DEBUG]: gmt_project_init: IN: Inc [0/0] n_columns/n_rows [2161/1081] dpi = 0 offset = 0\r\ngrdimage [DEBUG]: gmt_project_init: OUT: Inc [0/0] n_columns/n_rows [2161/1081] dpi = 0 offset = 0\r\ngrdimage [INFORMATION]: Grid projection from size 2161x1081 to 2161x1081\r\ngrdimage [DEBUG]: Successfully added data array to previously registered Grid container\r\ngrdimage [DEBUG]: gmt_grd_project: In [-180/180/-90/90] and out [0/6/0/3.81971863421]\r\ngrdimage [WARNING]: gmt_grd_project: Output grid extrema [-1.89669/1.87961] exceed extrema of input grid [-0.97649/0.970346] due to resampling\r\ngrdimage [WARNING]: gmt_grd_project: Output grid clipped to input grid extrema\r\ngrdimage [DEBUG]: GMT_Destroy_Data: freed memory for a Grid for object 2\r\ngrdimage [DEBUG]: gmtapi_unregister_io: Unregistering object no 2 [n_objects = 3]\r\ngrdimage [DEBUG]: gmtapi_unregister_io: Object no 2 has non-NULL resource pointer\r\ngrdimage [INFORMATION]: Given grid header, select default CPT to be turbo\r\ngrdimage [DEBUG]: Look for file geo in /Users/liamtoney/.gmt\r\ngrdimage [DEBUG]: Look for file geo in /Users/liamtoney/.gmt/cache\r\ngrdimage [DEBUG]: Look for file geo in /Users/liamtoney/.gmt/server\r\ngrdimage [DEBUG]: Look for file geo in /Users/liamtoney/.gmt/server/srtm1\r\ngrdimage [DEBUG]: Look for file geo in /Users/liamtoney/.gmt/server/srtm3\r\ngrdimage [ERROR]: Passing max <= zmin prevents automatic CPT generation!\r\ngrdimage [ERROR]: Failed to read CPT geo.\r\ngrdimage [DEBUG]: gmtapi_garbage_collection: Destroying object: C=0 A=0 ID=5 W=Input F=Grid M=Memory Reference S=Unused P=7fc1cc765be0 N=(null)\r\ngrdimage [DEBUG]: gmtapi_garbage_collection: Destroying object: C=0 A=0 ID=6 W=Input F=Grid M=Memory Reference S=Unused P=7fc1cc73a3e0 N=(null)\r\ngrdimage [DEBUG]: GMTAPI_Garbage_Collection freed 2 memory objects\r\ngrdimage [DEBUG]: gmtapi_unregister_io: Unregistering object no 5 [n_objects = 2]\r\ngrdimage [DEBUG]: gmtapi_unregister_io: Unregistering object no 6 [n_objects = 1]\r\ngrdimage (gmtlib_free_tmp_arrays): tried to free unallocated memory\r\nError: /syntaxerror in --%ztokenexec_continue--\r\nOperand stack:\r\n   PSL_draw_path_lines\r\nExecution stack:\r\n   %interp_exit   .runexec2   --nostringval--   --nostringval--   --nostringval--   2   %stopped_push   --nostringval--   --nostringval--   --nostringval--   false   1   %stopped_push   1999   1   3   %oparray_pop   1998   1   3   %oparray_pop   1982   1   3   %oparray_pop   1868   1   3   %oparray_pop   --nostringval--   %errorexec_pop   .runexec2   --nostringval--   --nostringval--   --nostringval--   2   %stopped_push   --nostringval--\r\nDictionary stack:\r\n   --dict:981/1684(ro)(G)--   --dict:0/20(G)--   --dict:78/200(L)--   --dict:136/250(L)--\r\nCurrent allocation mode is local\r\nLast OS error: No such file or directory\r\npsconvert [ERROR]: System call [gs -q -dSAFER -dNOPAUSE -dBATCH -sDEVICE=bbox -DPSL_no_pagefill -dMaxBitmap=2147483647 -dUseFastColor=true '/Users/liamtoney/.gmt/sessions/gmt6.9323/gmt_8.ps-' 2> '/Users/liamtoney/.gmt/sessions/gmt6.9323/psconvert_9323c.bb'] returned error 256.\r\n---------------------------------------------------------------------------\r\nGMTCLibError                              Traceback (most recent call last)\r\n<ipython-input-21-0836d05457e7> in <module>\r\n      8              projection='Cyl_stere/6i', cmap='geo', shading=True, V='d')\r\n      9\r\n---> 10 fig.show(method='external')\r\n\r\n~/repos/pygmt/pygmt/figure.py in show(self, dpi, width, method)\r\n    265             raise GMTInvalidInput(\"Invalid show method '{}'.\".format(method))\r\n    266         if method == \"external\":\r\n--> 267             pdf = self._preview(fmt=\"pdf\", dpi=dpi, anti_alias=False, as_bytes=False)\r\n    268             launch_external_viewer(pdf)\r\n    269             img = None\r\n\r\n~/repos/pygmt/pygmt/figure.py in _preview(self, fmt, dpi, as_bytes, **kwargs)\r\n    340         \"\"\"\r\n    341         fname = os.path.join(self._preview_dir.name, \"{}.{}\".format(self._name, fmt))\r\n--> 342         self.savefig(fname, dpi=dpi, **kwargs)\r\n    343         if as_bytes:\r\n    344             with open(fname, \"rb\") as image:\r\n\r\n~/repos/pygmt/pygmt/figure.py in savefig(self, fname, transparent, crop, anti_alias, show, **kwargs)\r\n    223             kwargs[\"W\"] = \"+k\"\r\n    224\r\n--> 225         self.psconvert(prefix=prefix, fmt=fmt, crop=crop, **kwargs)\r\n    226         if show:\r\n    227             launch_external_viewer(fname)\r\n\r\n~/repos/pygmt/pygmt/helpers/decorators.py in new_module(*args, **kwargs)\r\n    181                 if alias in kwargs:\r\n    182                     kwargs[arg] = kwargs.pop(alias)\r\n--> 183             return module_func(*args, **kwargs)\r\n    184\r\n    185         new_module.aliases = aliases\r\n\r\n~/repos/pygmt/pygmt/helpers/decorators.py in new_module(*args, **kwargs)\r\n    289                         )\r\n    290             # Execute the original function and return its output\r\n--> 291             return module_func(*args, **kwargs)\r\n    292\r\n    293         return new_module\r\n\r\n~/repos/pygmt/pygmt/figure.py in psconvert(self, **kwargs)\r\n    163             kwargs[\"A\"] = \"\"\r\n    164         with Session() as lib:\r\n--> 165             lib.call_module(\"psconvert\", build_arg_string(kwargs))\r\n    166\r\n    167     def savefig(\r\n\r\n~/repos/pygmt/pygmt/clib/session.py in call_module(self, module, args)\r\n    487             raise GMTCLibError(\r\n    488                 \"Module '{}' failed with status code {}:\\n{}\".format(\r\n--> 489                     module, status, self._error_message\r\n    490                 )\r\n    491             )\r\n\r\nGMTCLibError: Module 'psconvert' failed with status code 78:\r\npsconvert [ERROR]: System call [gs -q -dSAFER -dNOPAUSE -dBATCH -sDEVICE=bbox -DPSL_no_pagefill -dMaxBitmap=2147483647 -dUseFastColor=true '/Users/liamtoney/.gmt/sessions/gmt6.9323/gmt_8.ps-' 2> '/Users/liamtoney/.gmt/sessions/gmt6.9323/psconvert_9323c.bb'] returned error 256.\r\n```\r\n</details>\r\n\r\n**System information**\r\n\r\n* Operating system: macOS Catalina 10.15.1\r\n* Python installation (Anaconda, system, ETS): miniconda\r\n* Version of GMT: 6.0.0\r\n* Version of Python: 3.7.3\r\n* Version of this package: 55af9b67b5f04a1cde30cba013eec31d44874d4f\r\n* If using conda, paste the output of `conda list` below:\r\n\r\n<details>\r\n<summary>output of conda list</summary>\r\n<pre>\r\n# packages in environment at /Users/liamtoney/miniconda3/envs/pygmt:\r\n#\r\n# Name                    Version                   Build  Channel\r\nalabaster                 0.7.12                     py_0    conda-forge\r\nappdirs                   1.4.3                      py_1    conda-forge\r\nappnope                   0.1.0                 py37_1000    conda-forge\r\nasn1crypto                1.2.0                    py37_0    conda-forge\r\nastroid                   2.3.2                    py37_0    conda-forge\r\natomicwrites              1.3.0                      py_0    conda-forge\r\nattrs                     19.3.0                     py_0    conda-forge\r\nbabel                     2.7.0                      py_0    conda-forge\r\nbackcall                  0.1.0                      py_0    conda-forge\r\nblack                     19.3b0                     py_0    conda-forge\r\nbleach                    3.1.0                      py_0    conda-forge\r\nboost-cpp                 1.70.0               h75728bb_2    conda-forge\r\nbzip2                     1.0.8                h01d97ff_1    conda-forge\r\nca-certificates           2019.9.11            hecc5488_0    conda-forge\r\ncairo                     1.16.0            he1c11cd_1002    conda-forge\r\ncertifi                   2019.9.11                py37_0    conda-forge\r\ncffi                      1.13.1           py37h33e799b_0    conda-forge\r\ncfitsio                   3.470                h84d2f63_2    conda-forge\r\ncftime                    1.0.4.2          py37h3b54f70_0    conda-forge\r\nchardet                   3.0.4                 py37_1003    conda-forge\r\nclick                     7.0                        py_0    conda-forge\r\ncoverage                  4.5.4            py37h01d97ff_0    conda-forge\r\ncryptography              2.7              py37h212c5bf_0    conda-forge\r\ncurl                      7.65.3               h22ea746_0    conda-forge\r\ncycler                    0.10.0                     py_2    conda-forge\r\ndbus                      1.13.6               h2f22bb5_0    conda-forge\r\ndcw-gmt                   1.1.4                      1001    conda-forge\r\ndecorator                 4.4.0                      py_0    conda-forge\r\ndefusedxml                0.6.0                      py_0    conda-forge\r\ndocutils                  0.15.2                   py37_0    conda-forge\r\nentrypoints               0.3                   py37_1000    conda-forge\r\nexpat                     2.2.5             h4a8c4bd_1004    conda-forge\r\nffmpeg                    4.2                  h5c2b479_0    conda-forge\r\nfftw                      3.3.8           nompi_h9629793_1109    conda-forge\r\nflake8                    3.7.8                    py37_1    conda-forge\r\nfontconfig                2.13.1            h6b1039f_1001    conda-forge\r\nfreetype                  2.10.0               h24853df_1    conda-forge\r\nfreexl                    1.0.5             h1de35cc_1002    conda-forge\r\nfribidi                   1.0.5             h01d97ff_1002    conda-forge\r\ngdal                      3.0.1           py37h97c3584_10    conda-forge\r\ngeos                      3.7.2                h6de7cb9_2    conda-forge\r\ngeotiff                   1.5.1                h7e8e167_4    conda-forge\r\ngettext                   0.19.8.1          h46ab8bc_1002    conda-forge\r\nghostscript               9.22              h0a44026_1001    conda-forge\r\ngiflib                    5.1.7                h01d97ff_1    conda-forge\r\nglib                      2.58.3            h9d45998_1002    conda-forge\r\ngmp                       6.1.2             h0a44026_1000    conda-forge\r\ngmt                       6.0.0                h5e3c8ef_0    conda-forge\r\ngnuplot                   5.2.7                h14e7342_3    conda-forge\r\ngnutls                    3.6.5             h53004b3_1002    conda-forge\r\ngraphicsmagick            1.3.33               h04fbb9f_0    conda-forge\r\ngraphite2                 1.3.13            h2098e52_1000    conda-forge\r\ngshhg-gmt                 2.3.7                      1002    conda-forge\r\nharfbuzz                  2.4.0                hd8d2a14_3    conda-forge\r\nhdf4                      4.2.13            hf3c6af0_1002    conda-forge\r\nhdf5                      1.10.5          nompi_h3e39495_1104    conda-forge\r\nicu                       64.2                 h6de7cb9_1    conda-forge\r\nidna                      2.8                   py37_1000    conda-forge\r\nimagesize                 1.1.0                      py_0    conda-forge\r\nimportlib_metadata        0.23                     py37_0    conda-forge\r\nipykernel                 5.1.3            py37h5ca1d4c_0    conda-forge\r\nipython                   7.8.0            py37h5ca1d4c_0    conda-forge\r\nipython_genutils          0.2.0                      py_1    conda-forge\r\nipywidgets                7.5.1                      py_0    conda-forge\r\nisort                     4.3.21                   py37_0    conda-forge\r\njedi                      0.15.1                   py37_0    conda-forge\r\njinja2                    2.10.3                     py_0    conda-forge\r\njpeg                      9c                h1de35cc_1001    conda-forge\r\njson-c                    0.13.1            h1de35cc_1001    conda-forge\r\njsonschema                3.1.1                    py37_0    conda-forge\r\njupyter                   1.0.0                      py_2    conda-forge\r\njupyter_client            5.3.3                    py37_1    conda-forge\r\njupyter_console           6.0.0                      py_0    conda-forge\r\njupyter_core              4.5.0                      py_0    conda-forge\r\nkealib                    1.4.10            h6659575_1005    conda-forge\r\nkiwisolver                1.1.0            py37h770b8ee_0    conda-forge\r\nkrb5                      1.16.3            hcfa6398_1001    conda-forge\r\nlame                      3.100             h1de35cc_1001    conda-forge\r\nlazy-object-proxy         1.4.2            py37h01d97ff_0    conda-forge\r\nlibblas                   3.8.0               14_openblas    conda-forge\r\nlibcblas                  3.8.0               14_openblas    conda-forge\r\nlibclang                  8.0.1                h770b8ee_1    conda-forge\r\nlibcurl                   7.65.3               h16faf7d_0    conda-forge\r\nlibcxx                    9.0.0                h89e68fa_1    conda-forge\r\nlibdap4                   3.20.4               habf5908_0    conda-forge\r\nlibedit                   3.1.20170329      hcfe32e1_1001    conda-forge\r\nlibffi                    3.2.1             h6de7cb9_1006    conda-forge\r\nlibgd                     2.2.5             h5f83dcc_1006    conda-forge\r\nlibgdal                   3.0.1               h0158245_10    conda-forge\r\nlibgfortran               4.0.0                         2    conda-forge\r\nlibiconv                  1.15              h01d97ff_1005    conda-forge\r\nlibkml                    1.3.0             hed7d534_1010    conda-forge\r\nliblapack                 3.8.0               14_openblas    conda-forge\r\nlibllvm8                  8.0.1                h770b8ee_0    conda-forge\r\nlibnetcdf                 4.7.1           nompi_he14bcb6_101    conda-forge\r\nlibopenblas               0.3.7                h4bb4525_2    conda-forge\r\nlibpng                    1.6.37               h2573ce8_0    conda-forge\r\nlibpq                     11.5                 h756f0eb_1    conda-forge\r\nlibsodium                 1.0.17               h01d97ff_0    conda-forge\r\nlibspatialite             4.3.0a            hb0905fd_1031    conda-forge\r\nlibssh2                   1.8.2                hcdc9a53_2    conda-forge\r\nlibtiff                   4.0.10            hd08fb8f_1003    conda-forge\r\nlibwebp                   1.0.2                h14d73da_2    conda-forge\r\nlibxcb                    1.13              h1de35cc_1002    conda-forge\r\nlibxml2                   2.9.9                h12c6b28_5    conda-forge\r\nllvm-openmp               9.0.0                h40edb58_0    conda-forge\r\nlz4-c                     1.8.3             h6de7cb9_1001    conda-forge\r\nmarkupsafe                1.1.1            py37h1de35cc_0    conda-forge\r\nmatplotlib                3.1.1                    py37_1    conda-forge\r\nmatplotlib-base           3.1.1            py37h3a684a6_1    conda-forge\r\nmccabe                    0.6.1                      py_1    conda-forge\r\nmistune                   0.8.4           py37h1de35cc_1000    conda-forge\r\nmore-itertools            7.2.0                      py_0    conda-forge\r\nnbconvert                 5.6.0                    py37_1    conda-forge\r\nnbformat                  4.4.0                      py_1    conda-forge\r\nnbsphinx                  0.4.3                      py_0    conda-forge\r\nncurses                   6.1               h0a44026_1002    conda-forge\r\nnetcdf4                   1.5.3            py37he9269ea_0    conda-forge\r\nnettle                    3.4.1             h3efe00b_1002    conda-forge\r\nnose                      1.3.7                 py37_1002    conda-forge\r\nnotebook                  6.0.1                    py37_0    conda-forge\r\nnspr                      4.20              h0a44026_1000    conda-forge\r\nnss                       3.47                 hcec2283_0    conda-forge\r\nnumpy                     1.17.3           py37hde6bac1_0    conda-forge\r\nnumpydoc                  0.9.1                      py_0    conda-forge\r\nolefile                   0.46                       py_0    conda-forge\r\nopenh264                  1.8.0             hd9629dc_1000    conda-forge\r\nopenjpeg                  2.3.1                hdc36067_1    conda-forge\r\nopenssl                   1.1.1c               h01d97ff_0    conda-forge\r\npackaging                 19.2                       py_0    conda-forge\r\npandas                    0.25.2           py37h4f17bb1_0    conda-forge\r\npandoc                    2.7.3                         0    conda-forge\r\npandocfilters             1.4.2                      py_1    conda-forge\r\npango                     1.42.4               h6691c8e_1    conda-forge\r\nparso                     0.5.1                      py_0    conda-forge\r\npcre                      8.43                 h4a8c4bd_0    conda-forge\r\npexpect                   4.7.0                    py37_0    conda-forge\r\npickleshare               0.7.5                 py37_1000    conda-forge\r\npillow                    6.2.1            py37hb6f49c9_0    conda-forge\r\npip                       19.3.1                   py37_0    conda-forge\r\npixman                    0.38.0            h01d97ff_1003    conda-forge\r\npluggy                    0.13.0                   py37_0    conda-forge\r\npoppler                   0.67.0               hd5eb092_7    conda-forge\r\npoppler-data              0.4.9                         1    conda-forge\r\npostgresql                11.5                 h25afefd_1    conda-forge\r\nproj                      6.2.0                hca663eb_1    conda-forge\r\nprometheus_client         0.7.1                      py_0    conda-forge\r\nprompt_toolkit            2.0.10                     py_0    conda-forge\r\npthread-stubs             0.4               h1de35cc_1001    conda-forge\r\nptyprocess                0.6.0                   py_1001    conda-forge\r\npy                        1.8.0                      py_0    conda-forge\r\npycodestyle               2.5.0                      py_0    conda-forge\r\npycparser                 2.19                     py37_1    conda-forge\r\npyflakes                  2.1.1                      py_0    conda-forge\r\npygments                  2.4.2                      py_0    conda-forge\r\npylint                    2.4.3                    py37_0    conda-forge\r\npyopenssl                 19.0.0                   py37_0    conda-forge\r\npyparsing                 2.4.2                      py_0    conda-forge\r\npyqt                      5.12.3           py37h2a560b1_0    conda-forge\r\npyqt5-sip                 4.19.18                  pypi_0    pypi\r\npyqtwebengine             5.12.1                   pypi_0    pypi\r\npyrsistent                0.15.4           py37h01d97ff_0    conda-forge\r\npysocks                   1.7.1                    py37_0    conda-forge\r\npytest                    5.2.1                    py37_0    conda-forge\r\npytest-cov                2.8.1                      py_0    conda-forge\r\npytest-mpl                0.10                       py_0    conda-forge\r\npython                    3.7.3                h93065d6_1    conda-forge\r\npython-dateutil           2.8.0                      py_0    conda-forge\r\npytz                      2019.3                     py_0    conda-forge\r\npyzmq                     18.1.0           py37hee98d25_0    conda-forge\r\nqt                        5.12.5               h1b46049_0    conda-forge\r\nqtconsole                 4.5.5                      py_0    conda-forge\r\nreadline                  8.0                  hcfe32e1_0    conda-forge\r\nrequests                  2.22.0                   py37_1    conda-forge\r\nsend2trash                1.5.0                      py_0    conda-forge\r\nsetuptools                41.4.0                   py37_0    conda-forge\r\nsix                       1.12.0                py37_1000    conda-forge\r\nsnowballstemmer           2.0.0                      py_0    conda-forge\r\nsphinx                    1.8.5                    py37_0    conda-forge\r\nsphinx-gallery            0.4.0                    py37_0    conda-forge\r\nsphinx_rtd_theme          0.4.3                      py_0    conda-forge\r\nsphinxcontrib-websupport  1.1.2                      py_0    conda-forge\r\nsqlite                    3.30.1               h93121df_0    conda-forge\r\ntbb                       2018.0.5             h2d50403_0    conda-forge\r\nterminado                 0.8.2                    py37_0    conda-forge\r\ntestpath                  0.4.2                   py_1001    conda-forge\r\ntiledb                    1.6.2                h4f44bfb_1    conda-forge\r\ntk                        8.6.9             h2573ce8_1003    conda-forge\r\ntoml                      0.10.0                     py_0    conda-forge\r\ntornado                   6.0.3            py37h01d97ff_0    conda-forge\r\ntraitlets                 4.3.3                    py37_0    conda-forge\r\ntzcode                    2019a             h01d97ff_1002    conda-forge\r\nurllib3                   1.25.6                   py37_0    conda-forge\r\nwcwidth                   0.1.7                      py_1    conda-forge\r\nwebencodings              0.5.1                      py_1    conda-forge\r\nwheel                     0.33.6                   py37_0    conda-forge\r\nwidgetsnbextension        3.5.1                    py37_0    conda-forge\r\nwrapt                     1.11.2           py37h01d97ff_0    conda-forge\r\nx264                      1!152.20180806       h1de35cc_0    conda-forge\r\nxarray                    0.14.0                     py_0    conda-forge\r\nxerces-c                  3.2.2             hbda6038_1004    conda-forge\r\nxorg-kbproto              1.0.7             h1de35cc_1002    conda-forge\r\nxorg-libice               1.0.10               h01d97ff_0    conda-forge\r\nxorg-libsm                1.2.3             h01d97ff_1000    conda-forge\r\nxorg-libx11               1.6.9                h0b31af3_0    conda-forge\r\nxorg-libxau               1.0.9                h1de35cc_0    conda-forge\r\nxorg-libxdmcp             1.1.3                h01d97ff_0    conda-forge\r\nxorg-libxext              1.3.4                h01d97ff_0    conda-forge\r\nxorg-xextproto            7.3.0             h1de35cc_1002    conda-forge\r\nxorg-xproto               7.0.31            h1de35cc_1007    conda-forge\r\nxz                        5.2.4             h1de35cc_1001    conda-forge\r\nzeromq                    4.3.2                h6de7cb9_2    conda-forge\r\nzipp                      0.6.0                      py_0    conda-forge\r\nzlib                      1.2.11            h0b31af3_1006    conda-forge\r\nzstd                      1.4.0                ha9f0a20_0    conda-forge\r\n</pre>\r\n</details>\r\n",
    "closed_at": "2020-10-15T01:40:02Z",
    "closed_by": {
        "avatar_url": "https://avatars.githubusercontent.com/u/3974108?v=4",
        "events_url": "https://api.github.com/users/seisman/events{/privacy}",
        "followers_url": "https://api.github.com/users/seisman/followers",
        "following_url": "https://api.github.com/users/seisman/following{/other_user}",
        "gists_url": "https://api.github.com/users/seisman/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/seisman",
        "id": 3974108,
        "login": "seisman",
        "node_id": "MDQ6VXNlcjM5NzQxMDg=",
        "organizations_url": "https://api.github.com/users/seisman/orgs",
        "received_events_url": "https://api.github.com/users/seisman/received_events",
        "repos_url": "https://api.github.com/users/seisman/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/seisman/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/seisman/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/seisman"
    },
    "comments": 18,
    "comments_content": [
        {
            "author_association": "MEMBER",
            "body": "Hmm, I've managed to reproduce this on my computer. Might be something to do with the `virtualfile_from_grid` mechanism, but I can't tell for sure. Will need to investigate.",
            "created_at": "2019-11-02T21:53:36Z",
            "html_url": "https://github.com/GenericMappingTools/pygmt/issues/364#issuecomment-549084570",
            "id": 549084570,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364",
            "node_id": "MDEyOklzc3VlQ29tbWVudDU0OTA4NDU3MA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/549084570/reactions"
            },
            "updated_at": "2019-11-02T21:53:36Z",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/549084570",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23487320?v=4",
                "events_url": "https://api.github.com/users/weiji14/events{/privacy}",
                "followers_url": "https://api.github.com/users/weiji14/followers",
                "following_url": "https://api.github.com/users/weiji14/following{/other_user}",
                "gists_url": "https://api.github.com/users/weiji14/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/weiji14",
                "id": 23487320,
                "login": "weiji14",
                "node_id": "MDQ6VXNlcjIzNDg3MzIw",
                "organizations_url": "https://api.github.com/users/weiji14/orgs",
                "received_events_url": "https://api.github.com/users/weiji14/received_events",
                "repos_url": "https://api.github.com/users/weiji14/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/weiji14/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/weiji14/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/weiji14"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "My current work-around is to generate an illumination grid via `grdgradient` and apply that to my `grdimage` call, but it's pretty clunky.",
            "created_at": "2020-05-03T20:29:08Z",
            "html_url": "https://github.com/GenericMappingTools/pygmt/issues/364#issuecomment-623176484",
            "id": 623176484,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364",
            "node_id": "MDEyOklzc3VlQ29tbWVudDYyMzE3NjQ4NA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/623176484/reactions"
            },
            "updated_at": "2020-05-03T20:29:08Z",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/623176484",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/38269494?v=4",
                "events_url": "https://api.github.com/users/liamtoney/events{/privacy}",
                "followers_url": "https://api.github.com/users/liamtoney/followers",
                "following_url": "https://api.github.com/users/liamtoney/following{/other_user}",
                "gists_url": "https://api.github.com/users/liamtoney/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/liamtoney",
                "id": 38269494,
                "login": "liamtoney",
                "node_id": "MDQ6VXNlcjM4MjY5NDk0",
                "organizations_url": "https://api.github.com/users/liamtoney/orgs",
                "received_events_url": "https://api.github.com/users/liamtoney/received_events",
                "repos_url": "https://api.github.com/users/liamtoney/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/liamtoney/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/liamtoney/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/liamtoney"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Here it is, in all of its twice-nested-context-manager glory:\r\n\r\n```python\r\nimport pygmt\r\n\r\nfig = pygmt.Figure()\r\n\r\ndem = pygmt.datasets.load_earth_relief('10m')\r\n\r\nwith pygmt.helpers.GMTTempFile() as tmp_grd:\r\n    with pygmt.clib.Session() as session:\r\n        with session.virtualfile_from_grid(dem) as dem_file:\r\n            session.call_module('grdgradient', f'{dem_file} -A-45 -Nt1- -G{tmp_grd.name}')\r\n    fig.grdimage(dem, region=[-180, 180, -90, 90], frame='af',\r\n                 projection='Cyl_stere/6i', cmap='geo', shading=tmp_grd.name)\r\n\r\nfig.show(method='external')\r\n```",
            "created_at": "2020-05-03T20:49:17Z",
            "html_url": "https://github.com/GenericMappingTools/pygmt/issues/364#issuecomment-623179721",
            "id": 623179721,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364",
            "node_id": "MDEyOklzc3VlQ29tbWVudDYyMzE3OTcyMQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/623179721/reactions"
            },
            "updated_at": "2020-05-03T20:49:17Z",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/623179721",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/38269494?v=4",
                "events_url": "https://api.github.com/users/liamtoney/events{/privacy}",
                "followers_url": "https://api.github.com/users/liamtoney/followers",
                "following_url": "https://api.github.com/users/liamtoney/following{/other_user}",
                "gists_url": "https://api.github.com/users/liamtoney/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/liamtoney",
                "id": 38269494,
                "login": "liamtoney",
                "node_id": "MDQ6VXNlcjM4MjY5NDk0",
                "organizations_url": "https://api.github.com/users/liamtoney/orgs",
                "received_events_url": "https://api.github.com/users/liamtoney/received_events",
                "repos_url": "https://api.github.com/users/liamtoney/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/liamtoney/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/liamtoney/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/liamtoney"
            }
        },
        {
            "author_association": "NONE",
            "body": "@liamtoney For what it's worth, when I try your nested context manager\"solution\", I just get an error:\r\n\r\n`grdimage [ERROR]: Dimensions of intensity grid do not match that of the data grid!`\r\n\r\nUsing the `@` name, however, seems to work well - and runs MUCH faster, for some reason.",
            "created_at": "2020-06-09T16:59:41Z",
            "html_url": "https://github.com/GenericMappingTools/pygmt/issues/364#issuecomment-641447566",
            "id": 641447566,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY0MTQ0NzU2Ng==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/641447566/reactions"
            },
            "updated_at": "2020-06-09T16:59:41Z",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/641447566",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1500095?v=4",
                "events_url": "https://api.github.com/users/ibrewster/events{/privacy}",
                "followers_url": "https://api.github.com/users/ibrewster/followers",
                "following_url": "https://api.github.com/users/ibrewster/following{/other_user}",
                "gists_url": "https://api.github.com/users/ibrewster/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ibrewster",
                "id": 1500095,
                "login": "ibrewster",
                "node_id": "MDQ6VXNlcjE1MDAwOTU=",
                "organizations_url": "https://api.github.com/users/ibrewster/orgs",
                "received_events_url": "https://api.github.com/users/ibrewster/received_events",
                "repos_url": "https://api.github.com/users/ibrewster/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ibrewster/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ibrewster/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ibrewster"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> @liamtoney For what it's worth, when I try your nested context manager\"solution\", I just get an error:\r\n\r\nAre you running the **exact same code** as above? Perhaps using a different grid make yours not work? I just tested the above code again on the GMT Binder, and it worked fine. You can try it here:\r\n\r\n[![Binder](https://binder.pangeo.io/badge_logo.svg)](https://binder.pangeo.io/v2/gh/GenericMappingTools/try-gmt/master?urlpath=lab/tree/landing-page.ipynb)",
            "created_at": "2020-06-09T17:11:36Z",
            "html_url": "https://github.com/GenericMappingTools/pygmt/issues/364#issuecomment-641454439",
            "id": 641454439,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY0MTQ1NDQzOQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/641454439/reactions"
            },
            "updated_at": "2020-06-09T17:11:36Z",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/641454439",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/38269494?v=4",
                "events_url": "https://api.github.com/users/liamtoney/events{/privacy}",
                "followers_url": "https://api.github.com/users/liamtoney/followers",
                "following_url": "https://api.github.com/users/liamtoney/following{/other_user}",
                "gists_url": "https://api.github.com/users/liamtoney/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/liamtoney",
                "id": 38269494,
                "login": "liamtoney",
                "node_id": "MDQ6VXNlcjM4MjY5NDk0",
                "organizations_url": "https://api.github.com/users/liamtoney/orgs",
                "received_events_url": "https://api.github.com/users/liamtoney/received_events",
                "repos_url": "https://api.github.com/users/liamtoney/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/liamtoney/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/liamtoney/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/liamtoney"
            }
        },
        {
            "author_association": "NONE",
            "body": "Smaller grid (tried at 01m and 30s), smaller region, and different projection, but otherwise copied-and-pasted your code, yes.\r\n\r\nOf course, this is still just a workaround for `shading=True` not working (though, in my case, it actually crashes Python. Maybe Python version difference? Hmmm...)",
            "created_at": "2020-06-09T17:16:17Z",
            "html_url": "https://github.com/GenericMappingTools/pygmt/issues/364#issuecomment-641456809",
            "id": 641456809,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY0MTQ1NjgwOQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/641456809/reactions"
            },
            "updated_at": "2020-06-09T17:16:17Z",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/641456809",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1500095?v=4",
                "events_url": "https://api.github.com/users/ibrewster/events{/privacy}",
                "followers_url": "https://api.github.com/users/ibrewster/followers",
                "following_url": "https://api.github.com/users/ibrewster/following{/other_user}",
                "gists_url": "https://api.github.com/users/ibrewster/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ibrewster",
                "id": 1500095,
                "login": "ibrewster",
                "node_id": "MDQ6VXNlcjE1MDAwOTU=",
                "organizations_url": "https://api.github.com/users/ibrewster/orgs",
                "received_events_url": "https://api.github.com/users/ibrewster/received_events",
                "repos_url": "https://api.github.com/users/ibrewster/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ibrewster/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ibrewster/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ibrewster"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "@ibrewster I think it's an issue in regular GMT, see https://github.com/GenericMappingTools/gmt/issues/3408",
            "created_at": "2020-06-09T23:55:36Z",
            "html_url": "https://github.com/GenericMappingTools/pygmt/issues/364#issuecomment-641640135",
            "id": 641640135,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY0MTY0MDEzNQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/641640135/reactions"
            },
            "updated_at": "2020-06-09T23:55:36Z",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/641640135",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/38269494?v=4",
                "events_url": "https://api.github.com/users/liamtoney/events{/privacy}",
                "followers_url": "https://api.github.com/users/liamtoney/followers",
                "following_url": "https://api.github.com/users/liamtoney/following{/other_user}",
                "gists_url": "https://api.github.com/users/liamtoney/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/liamtoney",
                "id": 38269494,
                "login": "liamtoney",
                "node_id": "MDQ6VXNlcjM4MjY5NDk0",
                "organizations_url": "https://api.github.com/users/liamtoney/orgs",
                "received_events_url": "https://api.github.com/users/liamtoney/received_events",
                "repos_url": "https://api.github.com/users/liamtoney/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/liamtoney/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/liamtoney/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/liamtoney"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "It's confirmed to be a bug in GMT. Upstream PRs https://github.com/GenericMappingTools/gmt/pull/3510 and https://github.com/GenericMappingTools/gmt/pull/3512 fixed the bug and were already merged into GMT's master branch.\r\n\r\nIf you build the latest GMT master branch, running @liamtoney's example script in the top post will give you a beautiful earth relief map with shadings.\r\n\r\n![image](https://user-images.githubusercontent.com/3974108/85217544-23f96280-b360-11ea-926e-027cbc01b64a.png)\r\n\r\nFor users who don't want to manually build the GMT source codes, you can wait for the upcoming GMT 6.1.0, which is planned to be released before July 1st.\r\n\r\n---\r\n\r\n**NOTE for PyGMT maintainers:**\r\n\r\nWe should add a test for this after GMT 6.1.0 is released.",
            "created_at": "2020-06-21T05:43:49Z",
            "html_url": "https://github.com/GenericMappingTools/pygmt/issues/364#issuecomment-647082205",
            "id": 647082205,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY0NzA4MjIwNQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/647082205/reactions"
            },
            "updated_at": "2020-06-21T05:43:49Z",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/647082205",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3974108?v=4",
                "events_url": "https://api.github.com/users/seisman/events{/privacy}",
                "followers_url": "https://api.github.com/users/seisman/followers",
                "following_url": "https://api.github.com/users/seisman/following{/other_user}",
                "gists_url": "https://api.github.com/users/seisman/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/seisman",
                "id": 3974108,
                "login": "seisman",
                "node_id": "MDQ6VXNlcjM5NzQxMDg=",
                "organizations_url": "https://api.github.com/users/seisman/orgs",
                "received_events_url": "https://api.github.com/users/seisman/received_events",
                "repos_url": "https://api.github.com/users/seisman/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/seisman/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/seisman/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/seisman"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I noticed another issue with shading, this time in [`grdview()`](https://www.pygmt.org/latest/api/generated/pygmt.Figure.grdview.html#pygmt.Figure.grdview), when making #502  \u2014 posting here because I think it's the same problem and should be fixed by the GMT upstream fix \u2014 @seisman could you confirm?\r\n\r\n---\r\n\r\nHere I construct the same grid using both [`grdmath`](https://docs.generic-mapping-tools.org/latest/grdmath.html) (took me a bit!) and Python:\r\n\r\n### Pure GMT\r\n```shell\r\ngmt grdmath -R-5/5/-5/5 -I0.05 X Y HYPOT 0.5 0.5 POW MUL -0.2 MUL EXP -20 MUL 2 PI MUL X MUL COS 2 PI MUL Y MUL COS ADD 0.5 MUL EXP SUB E ADD 20 ADD = data.grd\r\n```\r\n\r\n### Python\r\n```python\r\nimport numpy as np\r\nimport xarray\r\n\r\ndef ackley(x, y):\r\n    return (\r\n        -20 * np.exp(-0.2 * np.sqrt(0.5 * (x ** 2 + y ** 2)))\r\n        - np.exp(0.5 * (np.cos(2 * np.pi * x) + np.cos(2 * np.pi * y)))\r\n        + np.exp(1)\r\n        + 20\r\n    )\r\n\r\nINC = 0.05\r\nx = np.arange(-5, 5 + INC, INC)\r\ny = np.arange(-5, 5 + INC, INC)\r\ndata = xarray.DataArray(ackley(*np.meshgrid(x, y)), coords=(x, y))\r\n```\r\n\r\n---\r\n\r\nThen the following script, with `INPUT = \"data.grd\"`, produces the correct result (at left) while `INPUT = data` produces an unexpected result (at right).\r\n```python\r\nimport pygmt\r\nfig = pygmt.Figure()\r\nSCALE = 0.2  # [inches]\r\nfig.grdview(\r\n    INPUT,\r\n    frame=[\"a5f1\", \"za5f1\"],\r\n    projection=f\"x{SCALE}i\",\r\n    zscale=f\"{SCALE}i\",\r\n    surftype=\"s\",\r\n    cmap=\"roma\",\r\n    perspective=\"135/30\",\r\n    I=\"+\",\r\n)\r\nfig.show()\r\n```\r\n`INPUT = \"data.grd\"` | `INPUT = data`\r\n:--:|:--:\r\n![good](https://user-images.githubusercontent.com/38269494/86252926-0f437880-bb71-11ea-85b2-4ebf68aea102.png)  |  ![bad](https://user-images.githubusercontent.com/38269494/86252935-11a5d280-bb71-11ea-9749-48521d3ff8ca.png)\r\n",
            "created_at": "2020-07-01T14:06:03Z",
            "html_url": "https://github.com/GenericMappingTools/pygmt/issues/364#issuecomment-652439374",
            "id": 652439374,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY1MjQzOTM3NA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/652439374/reactions"
            },
            "updated_at": "2020-07-01T14:06:03Z",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/652439374",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/38269494?v=4",
                "events_url": "https://api.github.com/users/liamtoney/events{/privacy}",
                "followers_url": "https://api.github.com/users/liamtoney/followers",
                "following_url": "https://api.github.com/users/liamtoney/following{/other_user}",
                "gists_url": "https://api.github.com/users/liamtoney/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/liamtoney",
                "id": 38269494,
                "login": "liamtoney",
                "node_id": "MDQ6VXNlcjM4MjY5NDk0",
                "organizations_url": "https://api.github.com/users/liamtoney/orgs",
                "received_events_url": "https://api.github.com/users/liamtoney/received_events",
                "repos_url": "https://api.github.com/users/liamtoney/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/liamtoney/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/liamtoney/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/liamtoney"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "@liamtoney It's a nice figure and a nice test! I can reproduce your issue with GMT 6.0.0, but **CAN'T** reproduce it with GMT master. I believe it's already fixed in upstream GMT.",
            "created_at": "2020-07-01T15:08:21Z",
            "html_url": "https://github.com/GenericMappingTools/pygmt/issues/364#issuecomment-652475731",
            "id": 652475731,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY1MjQ3NTczMQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/652475731/reactions"
            },
            "updated_at": "2020-07-01T15:08:21Z",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/652475731",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3974108?v=4",
                "events_url": "https://api.github.com/users/seisman/events{/privacy}",
                "followers_url": "https://api.github.com/users/seisman/followers",
                "following_url": "https://api.github.com/users/seisman/following{/other_user}",
                "gists_url": "https://api.github.com/users/seisman/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/seisman",
                "id": 3974108,
                "login": "seisman",
                "node_id": "MDQ6VXNlcjM5NzQxMDg=",
                "organizations_url": "https://api.github.com/users/seisman/orgs",
                "received_events_url": "https://api.github.com/users/seisman/received_events",
                "repos_url": "https://api.github.com/users/seisman/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/seisman/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/seisman/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/seisman"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> I believe it's already fixed in upstream GMT.\r\n\r\nAwesome, thanks for testing. I can edit the script in #502 to add `I=\"+\"` once we support newer GMT.",
            "created_at": "2020-07-01T15:28:18Z",
            "html_url": "https://github.com/GenericMappingTools/pygmt/issues/364#issuecomment-652487205",
            "id": 652487205,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY1MjQ4NzIwNQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/652487205/reactions"
            },
            "updated_at": "2020-07-01T15:28:18Z",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/652487205",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/38269494?v=4",
                "events_url": "https://api.github.com/users/liamtoney/events{/privacy}",
                "followers_url": "https://api.github.com/users/liamtoney/followers",
                "following_url": "https://api.github.com/users/liamtoney/following{/other_user}",
                "gists_url": "https://api.github.com/users/liamtoney/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/liamtoney",
                "id": 38269494,
                "login": "liamtoney",
                "node_id": "MDQ6VXNlcjM4MjY5NDk0",
                "organizations_url": "https://api.github.com/users/liamtoney/orgs",
                "received_events_url": "https://api.github.com/users/liamtoney/received_events",
                "repos_url": "https://api.github.com/users/liamtoney/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/liamtoney/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/liamtoney/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/liamtoney"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Confirmed that both of the problematic examples above are fixed using PyGMT 1.2.0 and (the actual fix) GMT 6.1.0!",
            "created_at": "2020-07-07T05:20:38Z",
            "html_url": "https://github.com/GenericMappingTools/pygmt/issues/364#issuecomment-654607900",
            "id": 654607900,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY1NDYwNzkwMA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/654607900/reactions"
            },
            "updated_at": "2020-07-07T05:20:47Z",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/654607900",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/38269494?v=4",
                "events_url": "https://api.github.com/users/liamtoney/events{/privacy}",
                "followers_url": "https://api.github.com/users/liamtoney/followers",
                "following_url": "https://api.github.com/users/liamtoney/following{/other_user}",
                "gists_url": "https://api.github.com/users/liamtoney/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/liamtoney",
                "id": 38269494,
                "login": "liamtoney",
                "node_id": "MDQ6VXNlcjM4MjY5NDk0",
                "organizations_url": "https://api.github.com/users/liamtoney/orgs",
                "received_events_url": "https://api.github.com/users/liamtoney/received_events",
                "repos_url": "https://api.github.com/users/liamtoney/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/liamtoney/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/liamtoney/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/liamtoney"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> We should add a test for this after GMT 6.1.0 is released.\r\n\r\nOk, GMT 6.1.0 is released and we've bumped the master branch of PyGMT to use it (thanks @seisman!). If someone wants to learn a bit about writing unit tests, this might an easy one to have a go at.",
            "created_at": "2020-07-11T21:41:12Z",
            "html_url": "https://github.com/GenericMappingTools/pygmt/issues/364#issuecomment-657134532",
            "id": 657134532,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY1NzEzNDUzMg==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/657134532/reactions"
            },
            "updated_at": "2020-07-11T21:41:12Z",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/657134532",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23487320?v=4",
                "events_url": "https://api.github.com/users/weiji14/events{/privacy}",
                "followers_url": "https://api.github.com/users/weiji14/followers",
                "following_url": "https://api.github.com/users/weiji14/following{/other_user}",
                "gists_url": "https://api.github.com/users/weiji14/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/weiji14",
                "id": 23487320,
                "login": "weiji14",
                "node_id": "MDQ6VXNlcjIzNDg3MzIw",
                "organizations_url": "https://api.github.com/users/weiji14/orgs",
                "received_events_url": "https://api.github.com/users/weiji14/received_events",
                "repos_url": "https://api.github.com/users/weiji14/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/weiji14/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/weiji14/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/weiji14"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I think that the docstring of grdimage needs to be updated. It is not clear what `shading=True` means (there is no similar option in gmt's grdimage). The default should be to provide an xarray grid, but this is not currently supported.",
            "created_at": "2020-08-05T13:20:09Z",
            "html_url": "https://github.com/GenericMappingTools/pygmt/issues/364#issuecomment-669189149",
            "id": 669189149,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY2OTE4OTE0OQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/669189149/reactions"
            },
            "updated_at": "2020-08-05T13:20:09Z",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/669189149",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8697285?v=4",
                "events_url": "https://api.github.com/users/MarkWieczorek/events{/privacy}",
                "followers_url": "https://api.github.com/users/MarkWieczorek/followers",
                "following_url": "https://api.github.com/users/MarkWieczorek/following{/other_user}",
                "gists_url": "https://api.github.com/users/MarkWieczorek/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/MarkWieczorek",
                "id": 8697285,
                "login": "MarkWieczorek",
                "node_id": "MDQ6VXNlcjg2OTcyODU=",
                "organizations_url": "https://api.github.com/users/MarkWieczorek/orgs",
                "received_events_url": "https://api.github.com/users/MarkWieczorek/received_events",
                "repos_url": "https://api.github.com/users/MarkWieczorek/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/MarkWieczorek/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/MarkWieczorek/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/MarkWieczorek"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "If the `shading` kwarg is not provided, then no shading is performed. If it is provided as `shading=True`, I think it should default to `+d` \u2014 see the GMT info here: https://docs.generic-mapping-tools.org/latest/grdimage.html#i. Currently, `shading=True` is the equivalent of `-I` with no args. According to the linked grdimage docs the default for a bare `-I` is no illumination. However, trying a simple GMT grdimage one-liner results in shading even if the bare `-I` is used. I.e., `-I` and `-I+d` return the same shaded image. (Side note: The gmt grdimage docs for the `-I` flag could be more clear on this.)\r\n\r\nIn any case, I agree that the docstring for grdimage needs to be updated. The docstring for grdview (dev docs) is here: https://www.pygmt.org/dev/api/generated/pygmt.Figure.grdview.html#pygmt.Figure.grdview. We could use the same for grdimage and grdview, but add in (for both) that `shading=True` is equivalent to `-I` which (apparently) is equivalent to `-I+d`.\r\n\r\n> The default should be to provide an xarray grid, but this is not currently supported.\r\n\r\nI don't understand what you mean by default in this context, but I do think this should be supported. Probably good to make a new feature request for this though.\r\n\r\n",
            "created_at": "2020-08-05T15:44:09Z",
            "html_url": "https://github.com/GenericMappingTools/pygmt/issues/364#issuecomment-669268901",
            "id": 669268901,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY2OTI2ODkwMQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/669268901/reactions"
            },
            "updated_at": "2020-08-05T15:44:09Z",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/669268901",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/38269494?v=4",
                "events_url": "https://api.github.com/users/liamtoney/events{/privacy}",
                "followers_url": "https://api.github.com/users/liamtoney/followers",
                "following_url": "https://api.github.com/users/liamtoney/following{/other_user}",
                "gists_url": "https://api.github.com/users/liamtoney/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/liamtoney",
                "id": 38269494,
                "login": "liamtoney",
                "node_id": "MDQ6VXNlcjM4MjY5NDk0",
                "organizations_url": "https://api.github.com/users/liamtoney/orgs",
                "received_events_url": "https://api.github.com/users/liamtoney/received_events",
                "repos_url": "https://api.github.com/users/liamtoney/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/liamtoney/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/liamtoney/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/liamtoney"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "For reference, here is what the gmt man page says about the `-I` parameter (the web documentation is worded slightly differently):\r\n\r\n> `usage: gmt grdimage ... -I[<intensgrid>|<value>|<modifiers]`\r\n\r\nand \r\n\r\n> \t`-I Apply directional illumination. Append name of intensity grid file.\r\n\t   For a constant intensity (i.e., change the ambient light), append a value.\r\n\t   To derive intensities from <grd_z> instead, append +a<azim> [-45], +n<method> [t1], and +m<ambient> [0]\r\n\t   or use -I+d to accept the default values (see grdgradient for details).\r\n\t   To derive from another grid than <grd_z>, give a filename as well.`\r\n\r\nThus, option 1 is to use a gridfile, option 2 is for a constant value, and option 3 is to derive intensities using grdgradient. If you chose option 3, then `+d` uses the default values of option 3.\r\n\r\nWhen the `-I` was first introduced, the only option was to specify a gridfile, and this usage persisted up until about gmt v5 when options 2 and 3 will introduced. This is why I just assumed that option 1 should be the default (i.e., I didn't know about the other 2 options until today!). However, `+d` might be a good fallback behaviour if `-I` is called with no other parameters.\r\n",
            "created_at": "2020-08-05T16:18:33Z",
            "html_url": "https://github.com/GenericMappingTools/pygmt/issues/364#issuecomment-669290256",
            "id": 669290256,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364",
            "node_id": "MDEyOklzc3VlQ29tbWVudDY2OTI5MDI1Ng==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/669290256/reactions"
            },
            "updated_at": "2020-08-05T16:18:33Z",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/669290256",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8697285?v=4",
                "events_url": "https://api.github.com/users/MarkWieczorek/events{/privacy}",
                "followers_url": "https://api.github.com/users/MarkWieczorek/followers",
                "following_url": "https://api.github.com/users/MarkWieczorek/following{/other_user}",
                "gists_url": "https://api.github.com/users/MarkWieczorek/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/MarkWieczorek",
                "id": 8697285,
                "login": "MarkWieczorek",
                "node_id": "MDQ6VXNlcjg2OTcyODU=",
                "organizations_url": "https://api.github.com/users/MarkWieczorek/orgs",
                "received_events_url": "https://api.github.com/users/MarkWieczorek/received_events",
                "repos_url": "https://api.github.com/users/MarkWieczorek/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/MarkWieczorek/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/MarkWieczorek/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/MarkWieczorek"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Looks like this got fixed in GMT upstream at https://github.com/GenericMappingTools/gmt/pull/4328, I see the xarray shading test we added in #581 is now an xpass instead of xfail. So anyone who builds GMT from source (or wait for GMT 6.2.0 in Feb/Mar 2021?) should not face this bug anymore. In the meantime, I've made a PR at https://github.com/conda-forge/gmt-feedstock/pull/108 so people can run `conda install -c conda-forge/label/dev gmt` to install a GMT development version to test things out now too :grin:",
            "created_at": "2020-10-15T00:22:38Z",
            "html_url": "https://github.com/GenericMappingTools/pygmt/issues/364#issuecomment-708750184",
            "id": 708750184,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364",
            "node_id": "MDEyOklzc3VlQ29tbWVudDcwODc1MDE4NA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/708750184/reactions"
            },
            "updated_at": "2021-01-21T21:16:03Z",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/708750184",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23487320?v=4",
                "events_url": "https://api.github.com/users/weiji14/events{/privacy}",
                "followers_url": "https://api.github.com/users/weiji14/followers",
                "following_url": "https://api.github.com/users/weiji14/following{/other_user}",
                "gists_url": "https://api.github.com/users/weiji14/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/weiji14",
                "id": 23487320,
                "login": "weiji14",
                "node_id": "MDQ6VXNlcjIzNDg3MzIw",
                "organizations_url": "https://api.github.com/users/weiji14/orgs",
                "received_events_url": "https://api.github.com/users/weiji14/received_events",
                "repos_url": "https://api.github.com/users/weiji14/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/weiji14/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/weiji14/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/weiji14"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Closed by GMT upstream PR https://github.com/GenericMappingTools/gmt/pull/4328.",
            "created_at": "2020-10-15T01:40:01Z",
            "html_url": "https://github.com/GenericMappingTools/pygmt/issues/364#issuecomment-708840577",
            "id": 708840577,
            "issue_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364",
            "node_id": "MDEyOklzc3VlQ29tbWVudDcwODg0MDU3Nw==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/708840577/reactions"
            },
            "updated_at": "2020-10-15T01:40:01Z",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/comments/708840577",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3974108?v=4",
                "events_url": "https://api.github.com/users/seisman/events{/privacy}",
                "followers_url": "https://api.github.com/users/seisman/followers",
                "following_url": "https://api.github.com/users/seisman/following{/other_user}",
                "gists_url": "https://api.github.com/users/seisman/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/seisman",
                "id": 3974108,
                "login": "seisman",
                "node_id": "MDQ6VXNlcjM5NzQxMDg=",
                "organizations_url": "https://api.github.com/users/seisman/orgs",
                "received_events_url": "https://api.github.com/users/seisman/received_events",
                "repos_url": "https://api.github.com/users/seisman/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/seisman/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/seisman/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/seisman"
            }
        }
    ],
    "comments_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364/comments",
    "created_at": "2019-11-02T18:08:40Z",
    "events_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364/events",
    "html_url": "https://github.com/GenericMappingTools/pygmt/issues/364",
    "id": 516675615,
    "labels": [
        {
            "color": "ee0701",
            "default": true,
            "description": "Something isn't working",
            "id": 563309827,
            "name": "bug",
            "node_id": "MDU6TGFiZWw1NjMzMDk4Mjc=",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/labels/bug"
        },
        {
            "color": "e8ff6b",
            "default": false,
            "description": "Bug or missing feature of upstream core GMT",
            "id": 2059525605,
            "name": "upstream",
            "node_id": "MDU6TGFiZWwyMDU5NTI1NjA1",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/labels/upstream"
        },
        {
            "color": "1b51aa",
            "default": false,
            "description": "Things to work on during the SciPy sprint!",
            "id": 2167714268,
            "name": "scipy-sprint",
            "node_id": "MDU6TGFiZWwyMTY3NzE0MjY4",
            "url": "https://api.github.com/repos/GenericMappingTools/pygmt/labels/scipy-sprint"
        }
    ],
    "labels_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": "2020-11-14T19:32:18Z",
        "closed_issues": 58,
        "created_at": "2020-09-17T21:24:34Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/3974108?v=4",
            "events_url": "https://api.github.com/users/seisman/events{/privacy}",
            "followers_url": "https://api.github.com/users/seisman/followers",
            "following_url": "https://api.github.com/users/seisman/following{/other_user}",
            "gists_url": "https://api.github.com/users/seisman/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/seisman",
            "id": 3974108,
            "login": "seisman",
            "node_id": "MDQ6VXNlcjM5NzQxMDg=",
            "organizations_url": "https://api.github.com/users/seisman/orgs",
            "received_events_url": "https://api.github.com/users/seisman/received_events",
            "repos_url": "https://api.github.com/users/seisman/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/seisman/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/seisman/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/seisman"
        },
        "description": "",
        "due_on": null,
        "html_url": "https://github.com/GenericMappingTools/pygmt/milestone/4",
        "id": 5890225,
        "labels_url": "https://api.github.com/repos/GenericMappingTools/pygmt/milestones/4/labels",
        "node_id": "MDk6TWlsZXN0b25lNTg5MDIyNQ==",
        "number": 4,
        "open_issues": 0,
        "state": "closed",
        "title": "0.2.1",
        "updated_at": "2020-12-14T00:38:58Z",
        "url": "https://api.github.com/repos/GenericMappingTools/pygmt/milestones/4"
    },
    "node_id": "MDU6SXNzdWU1MTY2NzU2MTU=",
    "number": 364,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364/reactions"
    },
    "repository_url": "https://api.github.com/repos/GenericMappingTools/pygmt",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364/timeline",
    "title": "grdimage shading fails for xarray input",
    "updated_at": "2021-01-21T21:16:03Z",
    "url": "https://api.github.com/repos/GenericMappingTools/pygmt/issues/364",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/38269494?v=4",
        "events_url": "https://api.github.com/users/liamtoney/events{/privacy}",
        "followers_url": "https://api.github.com/users/liamtoney/followers",
        "following_url": "https://api.github.com/users/liamtoney/following{/other_user}",
        "gists_url": "https://api.github.com/users/liamtoney/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/liamtoney",
        "id": 38269494,
        "login": "liamtoney",
        "node_id": "MDQ6VXNlcjM4MjY5NDk0",
        "organizations_url": "https://api.github.com/users/liamtoney/orgs",
        "received_events_url": "https://api.github.com/users/liamtoney/received_events",
        "repos_url": "https://api.github.com/users/liamtoney/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/liamtoney/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/liamtoney/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/liamtoney"
    }
}